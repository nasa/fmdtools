<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Defining Fault Sampling Approaches in fmdtools &mdash; fmdtools 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/fmdtools_ico.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Parallel Computing in fmdtools" href="../example_pump/Parallelism_Tutorial.html" />
    <link rel="prev" title="Pump Example Notebook" href="../example_pump/Pump_Example_Notebook.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo_glow.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../README.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#getting-started">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../README.html#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#contributions">Contributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../README.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#notices">Notices:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../README.html#disclaimers">Disclaimers</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Tutorial_complete.html">fmdtools Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Tutorial_complete.html#1.)-Loading-the-environment-and-model">1.) Loading the environment and model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Tutorial_complete.html#2.)-and-3.)-Simulate-and-visualize-the-results!">2.) and 3.) Simulate and visualize the results!</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Tutorial_complete.html#2a.)-Simulate-nominal">2a.) Simulate nominal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Tutorial_complete.html#2b.)-Visualize-nominal-model">2b.) Visualize nominal model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Tutorial_complete.html#2b.)-Simulate-a-fault-mode">2b.) Simulate a fault mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Tutorial_complete.html#3b.)-Visualize-fault-model-states">3b.) Visualize fault model states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Tutorial_complete.html#4a.)-Simulate-set-of-fault-modes">4a.) Simulate set of fault modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Tutorial_complete.html#4b.)-Visualize-set-of-fault-modes">4b.) Visualize set of fault modes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Tutorial_complete.html#5.)-Saving-Work">5.) Saving Work</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html">Defining and Visualizing fmdtools Model Structures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Model-Setup">Model Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Graph-Visualization">Graph Visualization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Graph-Views">Graph Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Run-Order">Run Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Behavior/Fault-Visualization">Behavior/Fault Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Model_Structure_Visualization_Tutorial.html#Visualizing-time-slices">Visualizing time-slices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_multirotor/Demonstration.html">fmdtools Paper Demonstration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example_multirotor/Demonstration.html#Initial-Model">Initial Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_multirotor/Demonstration.html#Setting-Node-Positions">Setting Node Positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_multirotor/Demonstration.html#Network-Model">Network Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_multirotor/Demonstration.html#Static-Model">Static Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_multirotor/Demonstration.html#Dynamic-Model">Dynamic Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_multirotor/Demonstration.html#Hierarchical-Model">Hierarchical Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../example_multirotor/Demonstration.html#Octocopter-Resilience">Octocopter Resilience</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html">Pump Example Notebook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Initial-Model-Checks">Initial Model Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Tables">Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Propagating-and-Viewing-Results-for-Individual-Faults">Propagating and Viewing Results for Individual Faults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Visualization-of-resilience-metrics">Visualization of resilience metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Running-a-List-of-Faults">Running a List of Faults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Running-a-Fault-Sampling-Approach">Running a Fault Sampling Approach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Pump_Example_Notebook.html#Save/Load">Save/Load</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Defining Fault Sampling Approaches in fmdtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Model-Setup">Model Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-up-an-approach">Setting up an approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Propagating-Faults">Propagating Faults</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Time-Sampling-Options">Time Sampling Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Pruning">Pruning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html">Using Parallel Computing in fmdtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Model-Checks">Model Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Using-Parallelism-in-Simulation">Using Parallelism in Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Performance-Comparison">Performance Comparison</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison:-No-Histories">Comparison: No Histories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison:-Many-Faults">Comparison: Many Faults</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison:-Long-simulation">Comparison: Long simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison:-Long-Simulation-No-Tracking">Comparison: Long Simulation No Tracking</a></li>
<li class="toctree-l4"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison:-Long-Simulation-Only-Necessary-Tracking">Comparison: Long Simulation Only Necessary Tracking</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison:-Lower-Tracking-Time-Resolution">Comparison: Lower Tracking Time Resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Comparison-Conclusions:">Comparison Conclusions:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Parallelism_Tutorial.html#Further-Computational-Cost-Reduction-via-Profiling">Further Computational Cost Reduction via Profiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Nominal_Approach_Use-Cases.html">Defining Nominal Approaches in fmdtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Nominal_Approach_Use-Cases.html#Quantifying-probabilities">Quantifying probabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Nominal_Approach_Use-Cases.html#Random-input-generation">Random input generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Nominal_Approach_Use-Cases.html#Nested-Scenario-Sampling">Nested Scenario Sampling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Stochastic_Modelling.html">Stochastic Modelling in fmdtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Stochastic_Modelling.html#Model-Setup">Model Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_pump/Stochastic_Modelling.html#Simulation-and-Analysis">Simulation and Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Stochastic_Modelling.html#Single-Scenario-Simulation">Single-Scenario Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Stochastic_Modelling.html#Multi-Scenario-Simulation">Multi-Scenario Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_pump/Stochastic_Modelling.html#Nested-Fault-Simulation">Nested Fault Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_tank/Tank_Analysis.html">Hold-up Tank Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example_tank/Tank_Analysis.html#Verifying-the-nominal-state:">Verifying the nominal state:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_tank/Tank_Analysis.html#What-happens-under-component-faults?">What happens under component faults?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_tank/Tank_Analysis.html#What-about-human-induced-faults?">What about human-induced faults?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_tank/Tank_Analysis.html#Evaluating-Joint-Component-Human-fault-modes">Evaluating Joint Component-Human fault modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example_tank/Tank_Analysis.html#Testing-different-reaction-times">Testing different reaction times</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_eps/EPS_Example_Notebook.html">EPS Example Notebook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fmdtools.html">Module Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fmdtools.faultsim.html">fmdtools.faultsim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fmdtools.faultsim.html#module-fmdtools.faultsim.networks">fmdtools.faultsim.networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmdtools.faultsim.html#fmdtools-faultsim-propagate">fmdtools.faultsim.propagate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fmdtools.resultdisp.html">fmdtools.resultdisp package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fmdtools.resultdisp.html#module-fmdtools.resultdisp.graph">fmdtools.resultdisp.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmdtools.resultdisp.html#module-fmdtools.resultdisp.plot">fmdtools.resultdisp.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmdtools.resultdisp.html#module-fmdtools.resultdisp.process">fmdtools.resultdisp.process</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmdtools.resultdisp.html#module-fmdtools.resultdisp.tabulate">fmdtools.resultdisp.tabulate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fmdtools.html#fmdtools-modeldef">fmdtools.modeldef</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fmdtools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Examples.html">Examples</a> &raquo;</li>
      <li>Defining Fault Sampling Approaches in fmdtools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/docs/Approach_Use-Cases.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Defining-Fault-Sampling-Approaches-in-fmdtools">
<h1>Defining Fault Sampling Approaches in fmdtools<a class="headerlink" href="#Defining-Fault-Sampling-Approaches-in-fmdtools" title="Permalink to this headline"></a></h1>
<p>Fault Sampling is used to evaluate the overall resilience of a system to a set of faults and the corresponding risks associated with these faults. There is no single best way to define the set of scenarios to evaluate resilience with, because a given resilience analysis may need more or less detail, support more or less computational time, or be interested in specific scenario types of interest.</p>
<p>Thus, there are a number of use-cases supported by fmdtools for different sampling models. This document will demonstrate and showcase a few of them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for use in development - makes sure git version is used instead of pip-installed version</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">fmdtools.modeldef</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">fmdtools.resultdisp</span> <span class="k">as</span> <span class="nn">rd</span>
<span class="kn">import</span> <span class="nn">fmdtools.faultsim.propagate</span> <span class="k">as</span> <span class="nn">prop</span>
<br/></pre></div>
</div>
</div>
<section id="Basics">
<h2>Basics<a class="headerlink" href="#Basics" title="Permalink to this headline"></a></h2>
<p>Fault sampling involves: - Defining faults and fault models within each function/component of the model (using the <code class="docutils literal notranslate"><span class="pre">.assoc_modes()</span></code> method) - Defining a fault sampling approach (using the <code class="docutils literal notranslate"><span class="pre">SampleApproach</span></code> class) - Propagating faults through the model (using the <code class="docutils literal notranslate"><span class="pre">propagate.approach</span></code> method) Before proceeding, it can be helpful to look through their respective documentation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">FxnBlock</span><span class="o">.</span><span class="n">assoc_modes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function assoc_modes in module fmdtools.modeldef:

assoc_modes(self, faultmodes={}, opermodes=[], initmode=&#39;nom&#39;, name=&#39;&#39;, probtype=&#39;rate&#39;, units=&#39;hr&#39;, exclusive=False, key_phases_by=&#39;global&#39;, longnames={})
    Associates fault and operational modes with the block when called in the function or component.

    Parameters
    ----------
    faultmodes : dict, optional
        Dictionary/Set of faultmodes with structure, which can have the forms:
            - set {&#39;fault1&#39;, &#39;fault2&#39;, &#39;fault3&#39;} (just the respective faults)
            - dict {&#39;fault1&#39;: faultattributes, &#39;fault2&#39;: faultattributes}, where faultattributes is:
                - float: rate for the mode
                - [float, float]: rate and repair cost for the mode
                - float, oppvect, float]: rate, opportunity vector, and repair cost for the mode
                opportunity vector can be specified as:
                    [float1, float2,...], a vector of relative likelihoods for each phase, or
                    {opermode:float1, opermode:float1}, a dict of relative likelihoods for each phase/mode
                    the phases/modes to key by are defined in &#34;key_phases_by&#34;
    opermodes : list, optional
        List of operational modes
    initmode : str, optional
        Initial operational mode. Default is &#39;nom&#39;
    name : str, optional
        (for components only) Name of the component. The default is &#39;&#39;.
    probtype : str, optional
        Type of probability in the probability model, a per-time &#39;rate&#39; or per-run &#39;prob&#39;.
        The default is &#39;rate&#39;
    units : str, optional
        Type of units (&#39;sec&#39;/&#39;min&#39;/&#39;hr&#39;/&#39;day&#39;) used for the rates. Default is &#39;hr&#39;
    exclusive : True/False
        Whether fault modes are exclusive of each other or not. Default is False (i.e. more than one can be present).
    key_phases_by : &#39;self&#39;/&#39;none&#39;/&#39;global&#39;/&#39;fxnname&#39;
        Phases to key the faultmodes by (using local, global, or an external function&#39;s modes&#39;). Default is &#39;global&#39;
    longnames : dict
        Longer names for the faults (if desired). {faultname: longname}

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">SampleApproach</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on class SampleApproach in module fmdtools.modeldef:

class SampleApproach(builtins.object)
 |  SampleApproach(mdl, faults=&#39;all&#39;, phases=&#39;global&#39;, modephases={}, jointfaults={&#39;faults&#39;: &#39;None&#39;}, sampparams={}, defaultsamp={&#39;samp&#39;: &#39;evenspacing&#39;, &#39;numpts&#39;: 1})
 |
 |  Class for defining the sample approach to be used for a set of faults.
 |
 |  Attributes
 |  ----------
 |  phases : dict
 |      phases given to sample the fault modes in
 |  globalphases : dict
 |      phases defined in the model
 |  modephases : dict
 |      Dictionary of modes associated with each state
 |  mode_phase_map : dict
 |      Mapping of modes to their corresponding phases
 |  tstep : float
 |      timestep defined in the model
 |  fxnrates : dict
 |      overall failure rates for each function
 |  comprates : dict
 |      overall failure rates for each component
 |  jointmodes : list
 |      (if any) joint fault modes to be injected in the approach
 |  rates/comprates/rates_timeless : dict
 |      rates of each mode (fxn, mode) in each model phase, structured {fxnmode: {phaseid:rate}}
 |  sampletimes : dict
 |      faults to inject at each time in each phase, structured {phaseid:time:fnxmode}
 |  weights : dict
 |      weight to put on each time each fault was injected, structured {fxnmode:phaseid:time:weight}
 |  sampparams : dict
 |      parameters used to sample each mode
 |  scenlist : list
 |      list of fault scenarios (dicts of faults and properties) that fault propagation iterates through
 |  scenids : dict
 |      a list of scenario ids associated with a given fault in a given phase, structured {(fxnmode,phaseid):listofnames}
 |  mode_phase_map : dict
 |      a dict of modes and their respective phases to inject with structure {fxnmode:{mode_phase_map:[starttime, endtime]}}
 |  units : str
 |      time-units to use in the approach probability model
 |  unit_factors : dict
 |      multiplication factors for converting some time units to others.
 |
 |  Methods defined here:
 |
 |  __init__(self, mdl, faults=&#39;all&#39;, phases=&#39;global&#39;, modephases={}, jointfaults={&#39;faults&#39;: &#39;None&#39;}, sampparams={}, defaultsamp={&#39;samp&#39;: &#39;evenspacing&#39;, &#39;numpts&#39;: 1})
 |      Initializes the sample approach for a given model
 |
 |      Parameters
 |      ----------
 |      mdl : Model
 |          Model to sample.
 |      faults : str/list/tuple, optional
 |          - The default is &#39;all&#39;, which gets all fault modes from the model.
 |          - &#39;single-components&#39; uses faults from a single component to represent faults form all components
 |          - passing the function name only includes modes from that function
 |          - List of faults of form [(fxn, mode)] to inject in the model.
 |          -Tuple arguments
 |              - (&#39;mode type&#39;, &#39;mode&#39;,&#39;notmode&#39;), gets all modes with &#39;mode&#39; as a string (e.g. &#34;mech&#34;, &#34;comms&#34;, &#34;loss&#34; faults). &#39;notmode&#39; (if given) specifies strings to remove
 |              - (&#39;mode types&#39;, (&#39;mode1&#39;, &#39;mode2&#39;)), gets all modes with the listed strings (e.g. &#34;mech&#34;, &#34;comms&#34;, &#34;loss&#34; faults)
 |              - (&#39;mode name&#39;, &#39;mode&#39;), gets all modes with the exact name &#39;mode&#39;
 |              - (&#39;mode names&#39;, (&#39;mode1&#39;, &#39;mode2&#39;)), gets all modes with the exact names defined in the tuple
 |              - (&#39;function class&#39;, &#39;Classname&#39;), which gets all modes from a function with class &#39;Classname&#39;
 |              - (&#39;function classes&#39;, (&#39;Classname1&#39;, &#39;Classname2&#39;)), which gets all modes from a function with the names in the tuple
 |      phases: dict or &#39;global&#39; or list
 |          Local phases in the model to sample.
 |              Dict has structure: {&#39;Function&#39;:{&#39;phase&#39;:[starttime, endtime]}}
 |              List has structure: [&#39;phase1&#39;, &#39;phase2&#39;] where phases are phases in mdl.phases
 |          Defaults to &#39;global&#39;,here only the phases defined in mdl.phases are used.
 |          Phases and modephases can be gotten from process.modephases(mdlhist)
 |      modephases: dict
 |          Dictionary of modes associated with each phase.
 |          For use when the opportunity vector is keyed to modes and each mode is
 |          entered multiple times in a simulation, resulting in
 |          multiple phases associated with that mode. Has structure:
 |              {&#39;Function&#39;:{&#39;mode&#39;:{&#39;phase&#39;,&#39;phase1&#39;, &#39;phase2&#39;...}}}
 |              Phases and modephases can be gotten from process.modephases(mdlhist)
 |      jointfaults : dict, optional
 |          Defines how the approach considers joint faults. The default is {&#39;faults&#39;:&#39;None&#39;}. Has structure:
 |              - faults : float
 |                  # of joint faults to inject. &#39;all&#39; specifies all faults at the same time
 |              - jointfuncs :  bool
 |                  determines whether more than one mode can be injected in a single function
 |              - pcond (optional) : float in range (0,1)
 |                  conditional probabilities for joint faults. If not give, independence is assumed.
 |              - inclusive (optional) : bool
 |                  specifies whether the fault set includes all joint faults up to the given level, or only the given level
 |                  (e.g., True with &#39;all&#39; means SampleApproach includes every combination of joint fault modes while
 |                         False with &#39;all&#39; means SampleApproach only includes the joint fault mode with all faults)
 |      sampparams : dict, optional
 |          Defines how specific modes in the model will be sampled over time. The default is {}.
 |          Has structure: {(fxnmode,phase): sampparam}, where sampparam has structure:
 |              - &#39;samp&#39; : str (&#39;quad&#39;, &#39;fullint&#39;, &#39;evenspacing&#39;,&#39;randtimes&#39;,&#39;symrandtimes&#39;)
 |                  sample strategy to use (quadrature, full integral, even spacing, random times, likeliest, or symmetric random times)
 |              - &#39;numpts&#39; : float
 |                  number of points to use (for evenspacing, randtimes, and symrandtimes only)
 |              - &#39;quad&#39; : dict
 |                  dict with structure {&#39;nodes&#39;[nodelist], &#39;weights&#39;:weightlist}
 |                  where the nodes in the nodelist range between -1 and 1
 |                  and the weights in the weightlist sum to 2.
 |      defaultsamp : TYPE, optional
 |          Defines how the model will be sampled over time by default. The default is {&#39;samp&#39;:&#39;evenspacing&#39;,&#39;numpts&#39;:1}. Has structure:
 |              - &#39;samp&#39; : str (&#39;quad&#39;, &#39;fullint&#39;, &#39;evenspacing&#39;,&#39;randtimes&#39;,&#39;symrandtimes&#39;)
 |                  sample strategy to use (quadrature, full integral, even spacing, random times,likeliest, or symmetric random times)
 |              - &#39;numpts&#39; : float
 |                  number of points to use (for evenspacing, randtimes, and symrandtimes only)
 |              - &#39;quad&#39; : dict
 |                  dict with structure {&#39;nodes&#39;[nodelist], &#39;weights&#39;:weightlist}
 |                  where the nodes in the nodelist range between -1 and 1
 |                  and the weights in the weightlist sum to 2.
 |
 |  add_phasetimes(self, fxnmode, phaseid, phasetimes, weights=[])
 |      Adds a set of times for a given mode to sampletimes
 |
 |  create_nomscen(self, mdl)
 |      Creates a nominal scenario
 |
 |  create_sampletimes(self, mdl, params={}, default={&#39;samp&#39;: &#39;evenspacing&#39;, &#39;numpts&#39;: 1})
 |      Initializes weights and sampletimes
 |
 |  create_scenarios(self)
 |      Creates list of scenarios to be iterated over in fault injection. Added as scenlist and scenids
 |
 |  init_modelist(self, mdl, faults, jointfaults={&#39;faults&#39;: &#39;None&#39;})
 |      Initializes comprates, jointmodes internal list of modes
 |
 |  init_rates(self, mdl, jointfaults={&#39;faults&#39;: &#39;None&#39;}, modephases={})
 |      Initializes rates, rates_timeless
 |
 |  list_moderates(self)
 |      Returns the rates for each mode
 |
 |  list_modes(self, joint=False)
 |      Returns a list of modes in the approach
 |
 |  prune_scenarios(self, endclasses, samptype=&#39;piecewise&#39;, threshold=0.1, sampparam={&#39;samp&#39;: &#39;evenspacing&#39;, &#39;numpts&#39;: 1})
 |      Finds the best sample approach to approximate the full integral (given the approach was the full integral).
 |
 |      Parameters
 |      ----------
 |      endclasses : dict
 |          dict of results (cost, rate, expected cost) for the model run indexed by scenid
 |      samptype : str (&#39;piecewise&#39; or &#39;bestpt&#39;), optional
 |          Method to use.
 |          If &#39;bestpt&#39;, finds the point in the interval that gives the average cost.
 |          If &#39;piecewise&#39;, attempts to split the inverval into sub-intervals of continuity
 |          The default is &#39;piecewise&#39;.
 |      threshold : float, optional
 |          If &#39;piecewise,&#39; the threshold for detecting a discontinuity based on deviation from linearity. The default is 0.1.
 |      sampparam : float, optional
 |          If &#39;piecewise,&#39; the sampparam sampparam to prune to. The default is {&#39;samp&#39;:&#39;evenspacing&#39;,&#39;numpts&#39;:1}, which would be a single point (optimal for linear).
 |
 |  select_points(self, param, possible_pts)
 |      Selects points in the list possible_points according to a given sample strategy.
 |
 |      Parameters
 |      ----------
 |      param : dict
 |          Sample parameter. Has structure:
 |              - &#39;samp&#39; : str (&#39;quad&#39;, &#39;fullint&#39;, &#39;evenspacing&#39;,&#39;randtimes&#39;,&#39;symrandtimes&#39;)
 |                  sample strategy to use (quadrature, full integral, even spacing, random times, or symmetric random times)
 |              - &#39;numpts&#39; : float
 |                  number of points to use (for evenspacing, randtimes, and symrandtimes only)
 |              - &#39;quad&#39; : dict
 |                  dict with structure {&#39;nodes&#39;[nodelist], &#39;weights&#39;:weightlist}
 |                  where the nodes in the nodelist range between -1 and 1
 |                  and the weights in the weightlist sum to 2.
 |      possible_pts :
 |          list of possible points in time.
 |
 |      Returns
 |      -------
 |      pts : list
 |          selected points
 |      weights : list
 |          weights for each point
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">approach</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function approach in module fmdtools.faultsim.propagate:

approach(mdl, app, staged=False, track=&#39;all&#39;, pool=False, showprogress=True, track_times=&#39;all&#39;, protect=True, run_stochastic=False, **kwargs)
    Injects and propagates faults in the model defined by a given sample approach

    Parameters
    ----------
    mdl : model
        The model to inject faults in.
    app : sampleapproach
        SampleApproach used to define the list of faults and sample time for the model.
    staged : bool, optional
        Whether to inject the fault in a copy of the nominal model at the fault time (True) or instantiate a new model for the fault (False). Setting to True roughly halves execution time. The default is False.
    track : str (&#39;all&#39;, &#39;functions&#39;, &#39;flows&#39;, &#39;valparams&#39;, dict, &#39;none&#39;), optional
        Which model states to track over time, which can be given as &#39;functions&#39;, &#39;flows&#39;,
        &#39;all&#39;, &#39;none&#39;, &#39;valparams&#39; (model states specified in mdl.valparams),
        or a dict of form {&#39;functions&#39;:{&#39;fxn1&#39;:&#39;att1&#39;}, &#39;flows&#39;:{&#39;flow1&#39;:&#39;att1&#39;}}
        The default is &#39;all&#39;.
    pool : process pool, optional
        Process Pool Object from multiprocessing or pathos packages. Pathos is recommended.
        e.g. parallelpool = mp.pool(n) for n cores (multiprocessing)
        or parallelpool = ProcessPool(nodes=n) for n cores (pathos)
        If False, the set of scenarios is run serially. The default is False
    showprogress: bool, optional
        whether to show a progress bar during execution. default is true
    track_times : str/tuple
        Defines what times to include in the history. Options are:
            &#39;all&#39;--all simulated times
            (&#39;interval&#39;, n)--includes every nth time in the history
            (&#39;times&#39;, [t1, ... tn])--only includes times defined in the vector [t1 ... tn]
    protect : bool
        Whether or not to protect the model object via copying
            True (default) - re-instances the model (safe)
            False - model is not re-instantiated (unsafe--do not use model afterwards)
    run_stochastic : bool
        Whether to run stochastic behaviors or use default values for stochastic variables. Default is False.
    **kwargs: kwargs (params, modelparams, and/or valparams)
        passing parameter dictionaries (e.g., params, modelparams, valparams) instantiates the model
        to be simulated with the given parameters. Parameter dictionaries do not
        need to be complete (if incomplete)
    Returns
    -------
    endclasses : dict
        A dictionary with the rate, cost, and expected cost of each scenario run with structure {scenname:{expected cost, cost, rate}}
    mdlhists : dict
        A dictionary with the history of all model states for each scenario (including the nominal)

</pre></div></div>
</div>
</section>
<section id="Model-Setup">
<h2>Model Setup<a class="headerlink" href="#Model-Setup" title="Permalink to this headline"></a></h2>
<p>Consider the following (highly simplified) rover electrical/navigation model. We can define the functions of this rover using the classes:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Move_Rover</span><span class="p">(</span><span class="n">FxnBlock</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span> <span class="n">flows</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">flows</span><span class="p">,</span> <span class="n">flownames</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;EE&quot;</span><span class="p">:</span><span class="s2">&quot;EE_in&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assoc_modes</span><span class="p">({</span><span class="s2">&quot;mech_loss&quot;</span><span class="p">,</span> <span class="s2">&quot;elec_open&quot;</span><span class="p">})</span>
    <span class="k">def</span> <span class="nf">behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">time</span><span class="p">:</span>
            <span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EE_in</span><span class="o">.</span><span class="n">v_supply</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">vel</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">no_fault</span><span class="p">(</span><span class="s2">&quot;elec_open&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EE_in</span><span class="o">.</span><span class="n">a_supply</span> <span class="o">=</span> <span class="n">power</span><span class="o">/</span><span class="mi">12</span>
            <span class="k">if</span> <span class="n">power</span> <span class="o">&gt;</span><span class="mi">100</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_fault</span><span class="p">(</span><span class="s2">&quot;elec_open&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>          <span class="bp">self</span><span class="o">.</span><span class="n">Ground</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ground</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">power</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">no_fault</span><span class="p">(</span><span class="s2">&quot;mech_loss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This use of <code class="docutils literal notranslate"><span class="pre">assoc_modes</span></code> specifies that there are two modes to inject, “mech_loss”, and “elec_open”, with no more information given for each mode. This is a syntax one might use as one is constructing the model and wishing to verify behaviors, or where modes are only caused behaviorally due to external scenarios. (in this case an open circuit is caused by too much power supply)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Control_Rover</span><span class="p">(</span><span class="n">FxnBlock</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span> <span class="n">flows</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">flows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assoc_modes</span><span class="p">({</span><span class="s1">&#39;no_con&#39;</span><span class="p">:[</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mi">200</span><span class="p">]},</span> <span class="p">[</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span><span class="s1">&#39;standby&#39;</span><span class="p">],</span> <span class="n">initmode</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s1">&#39;no_con&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">vel</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s1">&#39;standby&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">vel</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">power</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<p>This use of <code class="docutils literal notranslate"><span class="pre">assoc_modes</span></code> specifies modes (<code class="docutils literal notranslate"><span class="pre">no_con</span></code>) with a rate (1e-4) and a repair cost (200), as well as a set of operational modes that the system proceeds through. Specifying operational modes enables one to define different <em>behaviors</em> for the system depending on the configuration of the system at a given time. For example, in this function, the system goes into a drive mode at t=5, which powers on the system and outputs a command to move forward.</p>
<p>When operational modes are specified in the model, an initial mode must also be specified–in this case <code class="docutils literal notranslate"><span class="pre">initmode='standby'</span></code> specifies that the function starts in the standby mode.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Store_Energy</span><span class="p">(</span><span class="n">FxnBlock</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">flows</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">flows</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assoc_modes</span><span class="p">({</span><span class="s2">&quot;no_charge&quot;</span><span class="p">:[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;standby&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span> <span class="mi">100</span><span class="p">],</span><span class="s2">&quot;short&quot;</span><span class="p">:[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;supply&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span> <span class="mi">100</span><span class="p">],},</span> <span class="p">[</span><span class="s2">&quot;supply&quot;</span><span class="p">,</span><span class="s2">&quot;charge&quot;</span><span class="p">,</span><span class="s2">&quot;standby&quot;</span><span class="p">],</span> <span class="n">initmode</span><span class="o">=</span><span class="s2">&quot;standby&quot;</span><span class="p">,</span> <span class="n">exclusive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">key_phases_by</span><span class="o">=</span><span class="s1">&#39;self&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s2">&quot;standby&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">v_supply</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">a_supply</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">power</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="s2">&quot;supply&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s2">&quot;charge&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">charge</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s2">&quot;supply&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">v_supply</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep</span>
                <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="s2">&quot;no_charge&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">power</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="s2">&quot;standby&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s2">&quot;short&quot;</span><span class="p">):</span>     <span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">v_supply</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_mode</span><span class="p">(</span><span class="s2">&quot;no_charge&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">EE</span><span class="o">.</span><span class="n">v_supply</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<p>In addition to operational modes, the Battery Function additionally specifies an <em>opportunity vector</em> which defines when each fault mode is likely to occur (and thus be injected in the model). In this case, <code class="docutils literal notranslate"><span class="pre">no_charge</span></code> can only occur during standby mode, while a <code class="docutils literal notranslate"><span class="pre">short</span></code> can only occur during the supply mode. The <code class="docutils literal notranslate"><span class="pre">key_phases_by='self'</span></code> option specifies that these phases are <em>internal</em> to the function. Opporunity vectors can also be keyed to phases in other functions using
<code class="docutils literal notranslate"><span class="pre">key_phases_by='fxnname'</span></code> and <code class="docutils literal notranslate"><span class="pre">key_phases_by='global'</span></code>. There are several ways to define this opportunity vector, which will be described later.</p>
<p>This model also uses the <code class="docutils literal notranslate"><span class="pre">exclusive</span></code> option, which specifies that fault modes cannot co-occur with operational modes. That is, instead of <em>modifying</em> individual mode behaviors, fault modes in this function instead cause the system to enter a new mode with different defined mode behaviors.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fmdtools.resultdisp</span> <span class="k">as</span> <span class="nn">rd</span>
<span class="k">class</span> <span class="nc">Rover</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span>\
                 <span class="n">modelparams</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;times&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span> <span class="s1">&#39;tstep&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;phases&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;firsthalf&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;secondhalf&#39;</span><span class="p">:[</span><span class="mi">31</span><span class="p">,</span><span class="mi">60</span><span class="p">]}},</span>\
                 <span class="n">valparams</span><span class="o">=</span><span class="p">{}):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">modelparams</span><span class="p">,</span> <span class="n">valparams</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_flow</span><span class="p">(</span><span class="s1">&#39;Ground&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;dir&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;vel&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_flow</span><span class="p">(</span><span class="s1">&#39;EE&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;v_supply&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;a_supply&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_flow</span><span class="p">(</span><span class="s1">&#39;Control&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dir&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;vel&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_fxn</span><span class="p">(</span><span class="s2">&quot;Control_Rover&quot;</span><span class="p">,[</span><span class="s2">&quot;EE&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">],</span> <span class="n">fclass</span><span class="o">=</span><span class="n">Control_Rover</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_fxn</span><span class="p">(</span><span class="s2">&quot;Move_Rover&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Ground&quot;</span><span class="p">,</span><span class="s2">&quot;EE&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">],</span> <span class="n">fclass</span> <span class="o">=</span> <span class="n">Move_Rover</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_fxn</span><span class="p">(</span><span class="s2">&quot;Store_Energy&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;EE&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">],</span> <span class="n">Store_Energy</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">build_model</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scen</span><span class="p">,</span> <span class="n">mdlhists</span><span class="p">):</span>
        <span class="n">repcost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_repaircost</span><span class="p">()</span>
        <span class="n">reshist</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">summary</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhists</span><span class="p">)</span>
        <span class="n">losscost</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">bool</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">reshist</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;total faults&#39;</span><span class="p">]])</span>
        <span class="n">totcost</span><span class="o">=</span><span class="n">repcost</span><span class="o">+</span><span class="n">losscost</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span><span class="n">totcost</span><span class="p">,</span> <span class="s1">&#39;rate&#39;</span><span class="p">:</span><span class="n">scen</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">],</span> <span class="s1">&#39;expected cost&#39;</span><span class="p">:</span><span class="n">totcost</span><span class="o">*</span><span class="n">scen</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;global&quot;</span></code> phases in the model are defined using the ‘phases’ string in model parameters. Phases define distinct periods or activities of operation when the model may be in a different state (resulting in different potential failure mode effects and opportunities for failure modes to be entered).</p>
</section>
<section id="Setting-up-an-approach">
<h2>Setting up an approach<a class="headerlink" href="#Setting-up-an-approach" title="Permalink to this headline"></a></h2>
<p>Because this model has an opportunity vector which is keyed by its operational modes, the history of modes needs to be generated for the model to set up the sample approach–otherwise this information cannot be used, as shown below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Rover</span><span class="p">()</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To form this history, the model is run in the nominal scenario, as shown.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclass</span> <span class="p">,</span> <span class="n">resgraph</span><span class="p">,</span><span class="n">mdlhist</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">)</span>
<span class="n">mdlhist</span><span class="p">[</span><span class="s1">&#39;functions&#39;</span><span class="p">][</span><span class="s1">&#39;Store_Energy&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;faults&#39;: array([&#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;,
        &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;,
        &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;,
        &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;,
        &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;,
        &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;,
        &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;, &#39;nom&#39;], dtype=&#39;&lt;U9&#39;),
 &#39;charge&#39;: array([100, 100, 100, 100, 100, 100,  99,  98,  97,  96,  95,  94,  93,
         92,  91,  90,  89,  88,  87,  86,  85,  84,  83,  82,  81,  80,
         79,  78,  77,  76,  75,  74,  73,  72,  71,  70,  69,  68,  67,
         66,  65,  64,  63,  62,  61,  60,  59,  58,  57,  56,  55,  55,
         55,  55,  55,  55,  55,  55,  55,  55,  55]),
 &#39;mode&#39;: array([&#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;, &#39;supply&#39;,
        &#39;supply&#39;, &#39;supply&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;,
        &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;, &#39;standby&#39;,
        &#39;standby&#39;], dtype=&#39;&lt;U9&#39;)}
</pre></div></div>
</div>
<p>To get the phase information, the ‘process.modephases’ method is used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phases</span><span class="p">,</span> <span class="n">modephases</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">modephases</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Which returns <code class="docutils literal notranslate"><span class="pre">phases</span></code>, the phases of operation for each function where operational modes were defined:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phases</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;Control_Rover&#39;: {&#39;standby&#39;: [0, 4], &#39;drive&#39;: [5, 49], &#39;standby1&#39;: [50, 60]},
 &#39;Store_Energy&#39;: {&#39;standby&#39;: [0, 4], &#39;supply&#39;: [5, 49], &#39;standby1&#39;: [50, 60]}}
</pre></div></div>
</div>
<p>as well as <code class="docutils literal notranslate"><span class="pre">modephases</span></code>, which lists the phases associated with each mode.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modephases</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;Control_Rover&#39;: {&#39;standby&#39;: {&#39;standby&#39;, &#39;standby1&#39;}, &#39;drive&#39;: {&#39;drive&#39;}},
 &#39;Store_Energy&#39;: {&#39;standby&#39;: {&#39;standby&#39;, &#39;standby1&#39;}, &#39;supply&#39;: {&#39;supply&#39;}}}
</pre></div></div>
</div>
<p>These phases can be visualized with <code class="docutils literal notranslate"><span class="pre">rd.plot.phases</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">phases</span><span class="p">(</span><span class="n">phases</span><span class="p">,</span><span class="n">modephases</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_26_0.png" src="../_images/docs_Approach_Use-Cases_26_0.png" />
</div>
</div>
<p>To correctly sample according to the fault model’s intent (that each fault can occur within each <code class="docutils literal notranslate"><span class="pre">mode</span></code>), SampleApproach is given both <code class="docutils literal notranslate"><span class="pre">phases</span></code> and <code class="docutils literal notranslate"><span class="pre">modephases</span></code>, as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_correct</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="n">phases</span><span class="p">,</span> <span class="n">modephases</span><span class="o">=</span><span class="n">modephases</span><span class="p">)</span>
<span class="n">app_correct</span><span class="o">.</span><span class="n">sampletimes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(&#39;global&#39;,
  &#39;firsthalf&#39;): {14: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;)]},
 (&#39;global&#39;,
  &#39;secondhalf&#39;): {45: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;)]},
 (&#39;Store_Energy&#39;, &#39;standby&#39;): {2: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;standby1&#39;): {54: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;supply&#39;): {27: [(&#39;Store_Energy&#39;, &#39;short&#39;)]}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">phases</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_incorrect</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="n">phases</span><span class="p">)</span>
<span class="n">app_incorrect</span><span class="o">.</span><span class="n">sampletimes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(&#39;global&#39;,
  &#39;firsthalf&#39;): {14: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;)]},
 (&#39;global&#39;,
  &#39;secondhalf&#39;): {45: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;)]},
 (&#39;Store_Energy&#39;, &#39;standby&#39;): {2: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;supply&#39;): {27: [(&#39;Store_Energy&#39;, &#39;short&#39;)]}}
</pre></div></div>
</div>
<p>As shown, in the first sampleapproach, only the first phases of the mode are sampled, and not the second phases, because there is nothing to tell the approach which phases are associated with which mode, and the opportunity vector was keyed by modes. However, there are cases where it may not be necessary to provide <code class="docutils literal notranslate"><span class="pre">modephases</span></code> when providing , specifically: - If the opportunity vector is defined in terms of local <code class="docutils literal notranslate"><span class="pre">phases</span></code> directly instead of <code class="docutils literal notranslate"><span class="pre">modes</span></code>, (e.g. by <code class="docutils literal notranslate"><span class="pre">{standby</span></code>:rate,
<code class="docutils literal notranslate"><span class="pre">supply</span></code>:rate, <code class="docutils literal notranslate"><span class="pre">standby1</span></code>:rate})) - If only the first phase is of interest - If all fault modes are keyed by <code class="docutils literal notranslate"><span class="pre">global</span></code> phases</p>
<p>Note how different opportunity vectors lead to different sample approaches:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_correct</span><span class="o">.</span><span class="n">sampletimes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(&#39;global&#39;,
  &#39;firsthalf&#39;): {14: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;)]},
 (&#39;global&#39;,
  &#39;secondhalf&#39;): {45: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;)]},
 (&#39;Store_Energy&#39;, &#39;standby&#39;): {2: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;standby1&#39;): {54: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;supply&#39;): {27: [(&#39;Store_Energy&#39;, &#39;short&#39;)]}}
</pre></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Move_Rover</span></code>, and <code class="docutils literal notranslate"><span class="pre">Control_Rover</span></code>, where no opportunity vector was provided, are sampled once in the middle of an <code class="docutils literal notranslate"><span class="pre">operating</span></code> phase</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Store_Energy</span></code> is sampled once in each given phase (defined itself).</p></li>
<li><p>None of the modes are sampled during the global phases (although they could be, if that was provided in the function defintion)</p></li>
</ul>
<p>Joint fault modes can additionally be inserted in the model. These fault modes are given their own phases for rates and injection times by finding the overlap between the operational phases of their constituent modes:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_joint</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="n">phases</span><span class="p">,</span> <span class="n">modephases</span><span class="o">=</span><span class="n">modephases</span><span class="p">,</span> <span class="n">jointfaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;faults&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">app_joint</span><span class="o">.</span><span class="n">sampletimes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(&#39;global&#39;,
  &#39;firsthalf&#39;): {14: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;),
   ((&#39;Control_Rover&#39;, &#39;no_con&#39;), (&#39;Move_Rover&#39;, &#39;elec_open&#39;)),
   ((&#39;Control_Rover&#39;, &#39;no_con&#39;), (&#39;Move_Rover&#39;, &#39;mech_loss&#39;))]},
 (&#39;global&#39;,
  &#39;secondhalf&#39;): {45: [(&#39;Control_Rover&#39;, &#39;no_con&#39;),
   (&#39;Move_Rover&#39;, &#39;elec_open&#39;),
   (&#39;Move_Rover&#39;, &#39;mech_loss&#39;),
   ((&#39;Control_Rover&#39;, &#39;no_con&#39;), (&#39;Move_Rover&#39;, &#39;elec_open&#39;)),
   ((&#39;Control_Rover&#39;, &#39;no_con&#39;), (&#39;Move_Rover&#39;, &#39;mech_loss&#39;))]},
 (&#39;Store_Energy&#39;, &#39;standby&#39;): {2: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;standby1&#39;): {54: [(&#39;Store_Energy&#39;, &#39;no_charge&#39;)]},
 (&#39;Store_Energy&#39;, &#39;supply&#39;): {27: [(&#39;Store_Energy&#39;, &#39;short&#39;)]},
 ((&#39;global&#39;, &#39;firsthalf&#39;),
  (&#39;Store_Energy&#39;,
   &#39;standby&#39;)): {2: [((&#39;Control_Rover&#39;, &#39;no_con&#39;),
    (&#39;Store_Energy&#39;, &#39;no_charge&#39;)), ((&#39;Move_Rover&#39;, &#39;elec_open&#39;),
    (&#39;Store_Energy&#39;, &#39;no_charge&#39;)), ((&#39;Move_Rover&#39;, &#39;mech_loss&#39;),
    (&#39;Store_Energy&#39;, &#39;no_charge&#39;))]},
 ((&#39;global&#39;, &#39;secondhalf&#39;),
  (&#39;Store_Energy&#39;,
   &#39;standby1&#39;)): {54: [((&#39;Control_Rover&#39;, &#39;no_con&#39;),
    (&#39;Store_Energy&#39;, &#39;no_charge&#39;)), ((&#39;Move_Rover&#39;, &#39;elec_open&#39;),
    (&#39;Store_Energy&#39;, &#39;no_charge&#39;)), ((&#39;Move_Rover&#39;, &#39;mech_loss&#39;),
    (&#39;Store_Energy&#39;, &#39;no_charge&#39;))]},
 ((&#39;Store_Energy&#39;, &#39;supply&#39;),
  (&#39;global&#39;,
   &#39;firsthalf&#39;)): {17: [((&#39;Control_Rover&#39;, &#39;no_con&#39;),
    (&#39;Store_Energy&#39;, &#39;short&#39;)), ((&#39;Move_Rover&#39;, &#39;elec_open&#39;),
    (&#39;Store_Energy&#39;, &#39;short&#39;)), ((&#39;Move_Rover&#39;, &#39;mech_loss&#39;),
    (&#39;Store_Energy&#39;, &#39;short&#39;))]},
 ((&#39;Store_Energy&#39;, &#39;supply&#39;),
  (&#39;global&#39;,
   &#39;secondhalf&#39;)): {39: [((&#39;Control_Rover&#39;, &#39;no_con&#39;),
    (&#39;Store_Energy&#39;, &#39;short&#39;)), ((&#39;Move_Rover&#39;, &#39;elec_open&#39;),
    (&#39;Store_Energy&#39;, &#39;short&#39;)), ((&#39;Move_Rover&#39;, &#39;mech_loss&#39;),
    (&#39;Store_Energy&#39;, &#39;short&#39;))]}}
</pre></div></div>
</div>
</section>
<section id="Propagating-Faults">
<h2>Propagating Faults<a class="headerlink" href="#Propagating-Faults" title="Permalink to this headline"></a></h2>
<p>Given the fault sampling approach, the faults can then be propagated through the model to get results. Note that these faults can be sampled in parallel if desired using a user-provided pool (see the parallel pool tutorial in the <code class="docutils literal notranslate"><span class="pre">\pump</span> <span class="pre">example</span></code> folder).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses</span><span class="p">,</span> <span class="n">mdlhists</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">app_correct</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|███████████████████████████████████████████████████████████████| 9/9 [00:00&lt;00:00, 200.56it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;Control_Rover no_con, t=14&#39;: {&#39;cost&#39;: 247.0,
  &#39;rate&#39;: 0.0015,
  &#39;expected cost&#39;: 0.3705},
 &#39;Move_Rover elec_open, t=14&#39;: {&#39;cost&#39;: 47.0,
  &#39;rate&#39;: 7.5,
  &#39;expected cost&#39;: 352.5},
 &#39;Move_Rover mech_loss, t=14&#39;: {&#39;cost&#39;: 47.0,
  &#39;rate&#39;: 7.5,
  &#39;expected cost&#39;: 352.5},
 &#39;Control_Rover no_con, t=45&#39;: {&#39;cost&#39;: 216.0,
  &#39;rate&#39;: 0.0014500000000000001,
  &#39;expected cost&#39;: 0.31320000000000003},
 &#39;Move_Rover elec_open, t=45&#39;: {&#39;cost&#39;: 16.0,
  &#39;rate&#39;: 7.25,
  &#39;expected cost&#39;: 116.0},
 &#39;Move_Rover mech_loss, t=45&#39;: {&#39;cost&#39;: 16.0,
  &#39;rate&#39;: 7.25,
  &#39;expected cost&#39;: 116.0},
 &#39;Store_Energy no_charge, t=2&#39;: {&#39;cost&#39;: 159.0,
  &#39;rate&#39;: 2e-05,
  &#39;expected cost&#39;: 0.00318},
 &#39;Store_Energy no_charge, t=54&#39;: {&#39;cost&#39;: 107.0,
  &#39;rate&#39;: 5e-05,
  &#39;expected cost&#39;: 0.005350000000000001},
 &#39;Store_Energy short, t=27&#39;: {&#39;cost&#39;: 134.0,
  &#39;rate&#39;: 0.00044,
  &#39;expected cost&#39;: 0.058960000000000005},
 &#39;nominal&#39;: {&#39;cost&#39;: 0.0, &#39;rate&#39;: 1.0, &#39;expected cost&#39;: 0.0}}
</pre></div></div>
</div>
<p>Note that the results here reflect the lack of information given for rates in the <code class="docutils literal notranslate"><span class="pre">Control_Rover</span></code> and <code class="docutils literal notranslate"><span class="pre">Move_Rover</span></code> functions (which default to a value of 1) and the rates do not correspond <em>direct</em> to the given rates because rates shown here are per-run rates which are spread over the model. Additionally, all scenarios default to a cost of 1 because of the lack of a classification function.</p>
<p>These responses can be visualized:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">samplecosts</span><span class="p">(</span><span class="n">app_correct</span><span class="p">,</span> <span class="n">endclasses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_42_0.png" src="../_images/docs_Approach_Use-Cases_42_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_42_1.png" src="../_images/docs_Approach_Use-Cases_42_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_42_2.png" src="../_images/docs_Approach_Use-Cases_42_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_42_3.png" src="../_images/docs_Approach_Use-Cases_42_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_42_4.png" src="../_images/docs_Approach_Use-Cases_42_4.png" />
</div>
</div>
<section id="Time-Sampling-Options">
<h3>Time Sampling Options<a class="headerlink" href="#Time-Sampling-Options" title="Permalink to this headline"></a></h3>
<p>Above shows the default time-sampling option–a single fault sample in the middle of the operational phase. However, this approach can be varied to include multiple points for a more accurate sample. This is varied using the options: - defaultsamp (a dict), which specifies the default sampling approach for all faults/phases - sampparams (a dict), which specifies the sampling approach for individual faults/phases not included in the default</p>
<p>For example, in the following approach, we specify that each phase is represented by three evenly-spaced points</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_three</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="n">phases</span><span class="p">,</span> <span class="n">modephases</span><span class="o">=</span><span class="n">modephases</span><span class="p">,</span> <span class="n">defaultsamp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;samp&#39;</span><span class="p">:</span><span class="s1">&#39;evenspacing&#39;</span><span class="p">,</span> <span class="s1">&#39;numpts&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_three</span><span class="o">.</span><span class="n">times</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0, 1, 2, 3, 7, 14, 16, 22, 27, 37, 38, 45, 52, 52, 54, 57]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses_three</span><span class="p">,</span> <span class="n">mdlhists_three</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">app_three</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|█████████████████████████████████████████████████████████████| 28/28 [00:00&lt;00:00, 187.27it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">samplecosts</span><span class="p">(</span><span class="n">app_three</span><span class="p">,</span> <span class="n">endclasses_three</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_48_0.png" src="../_images/docs_Approach_Use-Cases_48_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_48_1.png" src="../_images/docs_Approach_Use-Cases_48_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_48_2.png" src="../_images/docs_Approach_Use-Cases_48_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_48_3.png" src="../_images/docs_Approach_Use-Cases_48_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_48_4.png" src="../_images/docs_Approach_Use-Cases_48_4.png" />
</div>
</div>
<p>We can also supply a quadrature externally by specifying a dictionary with node and weight positions. These can come from an external quadrature generator (e.g., quadpy, scipy).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="n">nodes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">_quadrature</span><span class="o">.</span><span class="n">_cached_roots_legendre</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.77459667,  0.        ,  0.77459667])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.55555556, 0.88888889, 0.55555556])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_quad</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="n">phases</span><span class="p">,</span> <span class="n">modephases</span><span class="o">=</span><span class="n">modephases</span><span class="p">,</span> <span class="n">defaultsamp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;samp&#39;</span><span class="p">:</span><span class="s1">&#39;quadrature&#39;</span><span class="p">,</span> <span class="s1">&#39;quad&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;nodes&#39;</span><span class="p">:</span><span class="n">nodes</span><span class="p">,</span><span class="s1">&#39;weights&#39;</span><span class="p">:</span><span class="n">weights</span><span class="p">}})</span>
<span class="n">endclasses_quad</span><span class="p">,</span> <span class="n">mdlhists_quad</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">app_quad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|█████████████████████████████████████████████████████████████| 27/27 [00:00&lt;00:00, 204.18it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_quad</span><span class="o">.</span><span class="n">times</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0, 2, 3, 3, 10, 14, 26, 27, 34, 43, 45, 51, 54, 56, 58]
</pre></div></div>
</div>
<p>As shown, while the times are <em>similar</em> to an evenly-spaced quadrature, they are not quite the same. Additionally, the weights of the quadrature mean that some points matter more when calculating the overall sum of sample costs. This can be visualized below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">samplecosts</span><span class="p">(</span><span class="n">app_quad</span><span class="p">,</span> <span class="n">endclasses_quad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_56_0.png" src="../_images/docs_Approach_Use-Cases_56_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_56_1.png" src="../_images/docs_Approach_Use-Cases_56_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_56_2.png" src="../_images/docs_Approach_Use-Cases_56_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_56_3.png" src="../_images/docs_Approach_Use-Cases_56_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_56_4.png" src="../_images/docs_Approach_Use-Cases_56_4.png" />
</div>
</div>
<p>We can also sample every time–this is costly (often prohibitively). However, one has more assurance with a full approach that the overall integration will be accurate, an important consideration when the resilience loss function is nonlinear (e.g., systems where there are delays or step-changes in the faulty behavior)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_full</span> <span class="o">=</span> <span class="n">SampleApproach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">phases</span><span class="o">=</span><span class="n">phases</span><span class="p">,</span> <span class="n">modephases</span><span class="o">=</span><span class="n">modephases</span><span class="p">,</span> <span class="n">defaultsamp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;samp&#39;</span><span class="p">:</span><span class="s1">&#39;fullint&#39;</span><span class="p">})</span>
<span class="n">endclasses_full</span><span class="p">,</span> <span class="n">mdlhists_full</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">app_full</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|███████████████████████████████████████████████████████████| 235/235 [00:01&lt;00:00, 174.33it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">samplecosts</span><span class="p">(</span><span class="n">app_full</span><span class="p">,</span> <span class="n">endclasses_full</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_59_0.png" src="../_images/docs_Approach_Use-Cases_59_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_59_1.png" src="../_images/docs_Approach_Use-Cases_59_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_59_2.png" src="../_images/docs_Approach_Use-Cases_59_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_59_3.png" src="../_images/docs_Approach_Use-Cases_59_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_59_4.png" src="../_images/docs_Approach_Use-Cases_59_4.png" />
</div>
</div>
<p>As shown, the cost function is effectively linear over time. This is expected, since the costs we put in <code class="docutils literal notranslate"><span class="pre">find_classification</span></code> are based on the amount of time the fault is present in the simulation.</p>
</section>
</section>
<section id="Pruning">
<h2>Pruning<a class="headerlink" href="#Pruning" title="Permalink to this headline"></a></h2>
<p>SampleApproach pruning can be used to reduce the number of points used to represent the overall costs. A pruned approach could then be used to re-run the set of faults at reduced computational costs, provided the time-based behavior has not changed significantly. This is performed using the SampleApproach.prune_scenarios method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">app_full</span><span class="o">.</span><span class="n">prune_scenarios</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method prune_scenarios in module fmdtools.modeldef:

prune_scenarios(endclasses, samptype=&#39;piecewise&#39;, threshold=0.1, sampparam={&#39;samp&#39;: &#39;evenspacing&#39;, &#39;numpts&#39;: 1}) method of fmdtools.modeldef.SampleApproach instance
    Finds the best sample approach to approximate the full integral (given the approach was the full integral).

    Parameters
    ----------
    endclasses : dict
        dict of results (cost, rate, expected cost) for the model run indexed by scenid
    samptype : str (&#39;piecewise&#39; or &#39;bestpt&#39;), optional
        Method to use.
        If &#39;bestpt&#39;, finds the point in the interval that gives the average cost.
        If &#39;piecewise&#39;, attempts to split the inverval into sub-intervals of continuity
        The default is &#39;piecewise&#39;.
    threshold : float, optional
        If &#39;piecewise,&#39; the threshold for detecting a discontinuity based on deviation from linearity. The default is 0.1.
    sampparam : float, optional
        If &#39;piecewise,&#39; the sampparam sampparam to prune to. The default is {&#39;samp&#39;:&#39;evenspacing&#39;,&#39;numpts&#39;:1}, which would be a single point (optimal for linear).

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_full</span><span class="o">.</span><span class="n">prune_scenarios</span><span class="p">(</span><span class="n">endclasses_full</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_full</span><span class="o">.</span><span class="n">times</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2, 14, 27, 45, 54]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses_pruned</span><span class="p">,</span> <span class="n">mdlhists_pruned</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">app_full</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|███████████████████████████████████████████████████████████████| 9/9 [00:00&lt;00:00, 195.51it/s]
</pre></div></div>
</div>
<p>As shown, with the default options the pruned sampling approach applies a centered single-point, as would happen using the default options. This would change if there were nonlinearities in the resilience loss function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">samplecosts</span><span class="p">(</span><span class="n">app_full</span><span class="p">,</span> <span class="n">endclasses_pruned</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_67_0.png" src="../_images/docs_Approach_Use-Cases_67_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_67_1.png" src="../_images/docs_Approach_Use-Cases_67_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_67_2.png" src="../_images/docs_Approach_Use-Cases_67_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_67_3.png" src="../_images/docs_Approach_Use-Cases_67_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/docs_Approach_Use-Cases_67_4.png" src="../_images/docs_Approach_Use-Cases_67_4.png" />
</div>
</div>
<p>A more detailed investigation of sampling approaches is provided in <code class="docutils literal notranslate"><span class="pre">/example_pump/IDETC_Results/IDETC_Figures.ipynb</span></code> and its corresponding paper:</p>
<p><em>Hulse, D., Hoyle, C., Tumer, I. Y., Goebel, K., &amp; Kulkarni, C. (2020, August). Temporal Fault Injection Considerations in Resilience Quantification. In International Design Engineering Technical Conferences and Computers and Information in Engineering Conference (Vol. 84003, p. V11AT11A040). American Society of Mechanical Engineers.</em></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../example_pump/Pump_Example_Notebook.html" class="btn btn-neutral float-left" title="Pump Example Notebook" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../example_pump/Parallelism_Tutorial.html" class="btn btn-neutral float-right" title="Using Parallel Computing in fmdtools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
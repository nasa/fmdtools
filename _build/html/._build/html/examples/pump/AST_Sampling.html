<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fmdtools-AdaStress integration &mdash; fmdtools 2.0-rc-3 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/nbsphinx-code-cells.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/fmdtools_ico.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/logo_glow.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#about">About</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#flexible-modelling-paradigm">Flexible Modelling Paradigm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#powerful-simulation-techniques">Powerful Simulation Techniques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#efficient-analysis-process">Efficient Analysis Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#set-up-python-environment">Set up python environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#install-fmdtools">Install fmdtools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../README.html#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#explore-tutorials-and-resources">Explore Tutorials and Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#contributions">Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#citing-this-repository">Citing this repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#license-notices">License/Notices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#disclaimers">Disclaimers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/Development%20Guide.html">Development Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#why-fmdtools">Why fmdtools?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#introductory-tutorial">Introductory Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html">Intro to resilience modeling, simulation, and visualization in Python with fmdtools.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#author-daniel-hulse">Author: Daniel Hulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#version-2-0-rc-3">Version: 2.0-rc-3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#motivation-modeling-system-resilience">Motivation: Modeling System Resilience</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-is-resilience-important">Why is Resilience Important?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#enabling-proactive-design-process">Enabling proactive design process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-fmdtools-possible-competitors">Why fmdtools? Possible Competitors:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-fmdtools-pros">Why fmdtools? Pros:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-not-fmdtools-cons">Why <strong>not</strong> fmdtools? Cons:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#what-is-fmdtools-a-python-package-for-design-simulation-and-analysis-of-resilience">What is fmdtools? A Python package for <strong>design</strong>, <strong>simulation</strong>, and <strong>analysis</strong> of resilience.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#what-is-fmdtools-repo-structure">What is fmdtools? Repo Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#activity-download-and-install-fmdtools">Activity: Download and Install fmdtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#analysis-workflow-structure">Analysis Workflow/Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#defining-a-model">Defining a Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#id1">Defining a Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#function-code-template">Function Code Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#model-code-template">Model Code Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#demo-model-activity-examples-pump-ex-pump-py">Demo Model Activity: examples/pump/ex_pump.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#more-resources-for-model-definition">More Resources for Model Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#notebook-activity">Notebook Activity:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-static-undirected-propagation">Simulation Concepts: Static/Undirected Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-propagation-over-time">Simulation Concepts: Propagation over Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-types-of-simulations">Simulation Concepts: Types of Simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-sampling-approaches">Simulation Concepts: Sampling Approaches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-things-to-consider">Simulation Concepts: Things to Consider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#activity-simulate-the-model">Activity: Simulate the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#analysis-modules">Analysis Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#analysis-activity">Analysis Activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#conclusions-summary">Conclusions/Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#further-reading-links">Further Reading/Links</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#model-development-best-practices">Model Development Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#pay-attention-to-and-document-the-fmdtools-version">Pay attention to and document the fmdtools version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#plan-your-model-to-avoid-technical-debt">Plan your model to avoid technical debt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#don-t-copy-inherit-and-functionalize">Don’t copy, inherit and functionalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#document-your-code-sometimes-before-your-write-it">Document your code, sometimes <em>before</em> your write it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#don-t-get-ahead-of-yourself-try-to-get-a-running-simulation-first">Don’t get ahead of yourself–try to get a running simulation first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#preserve-your-prototype-setup-by-formalizing-it-as-a-test">Preserve your prototype setup by formalizing it as a test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#edit-your-code">Edit your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#structuring-a-model">Structuring a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#use-model-constructs-to-simplify-your-code">Use model constructs to simplify your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#style-advice">Style advice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#how-to-contribute">How to Contribute</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#repo-structure">Repo Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Development%20Guide.html#remote-structure">Remote Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#development-process">Development Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Development%20Guide.html#release-checklist">Release Checklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Development%20Guide.html#upload-to-pypi">Upload to PyPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#roles">Roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#style-formatting">Style/Formatting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#testing">Testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/Examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#pump">Pump</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/pump/readme.html">Pump Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#multirotor">Multirotor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/multirotor/readme.html">Drone Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#tank">Tank</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/tank/readme.html">Tank Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#eps">EPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/eps/readme.html">EPS Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#action-sequence-graph">Action Sequence Graph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/asg_demo/readme.html">ASG Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/asg_demo/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/asg_demo/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/asg_demo/readme.html#notebooks">Notebooks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#rover">Rover</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/rover/readme.html">Rover Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#multiflow-demo">Multiflow Demo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html">MultiFlow Demo Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#taxiway">Taxiway</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/taxiway/readme.html">Taxiway Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/fmdtools.html">Module Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/fmdtools.define.html">fmdtools.define</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html">fmdtools.define.architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-base">fmdtools.define.architecture.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-action">fmdtools.define.architecture.action</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-component">fmdtools.define.architecture.component</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-function">fmdtools.define.architecture.function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-geom">fmdtools.define.architecture.geom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html">fmdtools.define.block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.base">fmdtools.define.block.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.action">fmdtools.define.block.action</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.component">fmdtools.define.block.component</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.function">fmdtools.define.block.function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html">fmdtools.define.container</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#fmdtools-define-container-base">fmdtools.define.container.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#module-fmdtools.define.container.mode">fmdtools.define.container.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#fmdtools-define-container-state">fmdtools.define.container.state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#fmdtools-define-container-parameter">fmdtools.define.container.parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#module-fmdtools.define.container.rand">fmdtools.define.container.rand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#module-fmdtools.define.container.time">fmdtools.define.container.time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html">fmdtools.define.flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html#fmdtools-define-flow-base">fmdtools.define.flow.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html#module-fmdtools.define.flow.multiflow">fmdtools.define.flow.multiflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html#module-fmdtools.define.flow.commsflow">fmdtools.define.flow.commsflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html">fmdtools.define.object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.base">fmdtools.define.object.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.timer">fmdtools.define.object.timer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.geom">fmdtools.define.object.geom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.coords">fmdtools.define.object.coords</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.html#fmdtools-define-base">fmdtools.define.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.html#module-fmdtools.define.environment">fmdtools.define.environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/fmdtools.sim.html">fmdtools.sim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#fmdtools-sim-propagate">fmdtools.sim.propagate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#module-fmdtools.sim.scenario">fmdtools.sim.scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#module-fmdtools.sim.sample">fmdtools.sim.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#module-fmdtools.sim.search">fmdtools.sim.search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html">fmdtools.analyze</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.common">fmdtools.analyze.common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.result">fmdtools.analyze.result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.history">fmdtools.analyze.history</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.graph">fmdtools.analyze.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.tabulate">fmdtools.analyze.tabulate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.phases">fmdtools.analyze.phases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CONTRIBUTORS.html">Contributors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#internal-contributors">Internal Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#external-contributors">External Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#alumni-and-interns">Alumni and Interns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#fmdtools-at-osu">fmdtools at OSU</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">fmdtools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">fmdtools-AdaStress integration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/._build/html/examples/pump/AST_Sampling.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fmdtools-AdaStress-integration">
<h1>fmdtools-AdaStress integration<a class="headerlink" href="#fmdtools-AdaStress-integration" title="Permalink to this heading"></a></h1>
<p><strong>NOTE: This notebook may not run correctly, see ticket RAD-224</strong></p>
<p>This goal of this notebook is to illustrate running <a class="reference external" href="https://www.nasa.gov/content/tech/rse/research/adastress">Adaptive Stress Testing</a> on fmdtools model using the AdaStress package.</p>
<p>For this setup to work, first install: - AdaStress (and related packages) in Julia - fmdtools (and related packages) in Python - PyCall in Julia - - Make sure ENV[“PYTHON”] points to python kernel where fmdtools is installed - PyJulia in Python</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Commands for building PyCall where python is located:</span>
<span class="c"># ENV[&quot;PYTHON&quot;] = &quot;C:\\Users\\dhulse\\AppData\\Local\\anaconda3\\python.exe&quot;</span>
<span class="c"># using Pkg</span>
<span class="c"># Pkg.build(&quot;PyCall&quot;)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="k">using</span><span class="w"> </span><span class="n">AdaStress</span>
</pre></div>
</div>
</div>
<section id="Python-setup:">
<h2>Python setup:<a class="headerlink" href="#Python-setup:" title="Permalink to this heading"></a></h2>
<p>First, we get the fmdtools model from its respective folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><br/><span></span><span class="k">using</span><span class="w"> </span><span class="n">PyCall</span>
<span class="c">#ENV[&quot;MPLBACKEND&quot;]=&quot;qt5agg&quot;</span>
<span class="k">using</span><span class="w"> </span><span class="n">PyPlot</span>
<span class="sa">py</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">import sys, os</span>
<span class="s">sys.path.insert(0,os.curdir)</span>
<span class="s">sys.path.insert(1,os.path.join(&#39;..&#39;))</span>
<span class="s">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">PyCall</span><span class="o">.</span><span class="n">pyversion</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
v&#34;3.10.9&#34;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">#pygui_start(:qt)</span>
<span class="c">#PyCall.fixqtpath()</span>
</pre></div>
</div>
</div>
<p>Next, we get the module–in this case we will be using the stochastic pump model in <code class="docutils literal notranslate"><span class="pre">/example_pump/pump_stochastic</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pump_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyimport</span><span class="p">(</span><span class="s">&quot;pump_stochastic&quot;</span><span class="p">)</span>
<span class="n">pump_model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pump_module</span><span class="o">.</span><span class="n">Pump</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;delay&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mf">1.0</span><span class="p">))</span>
<span class="n">pump_model</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyObject PumpParam(cost=(&#39;repair&#39;, &#39;water&#39;), delay=1)
</pre></div></div>
</div>
<p>To get the propagation/analysis methods, we can further import the fmdtools packages…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">fmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pyimport</span><span class="p">(</span><span class="s">&quot;fmdtools&quot;</span><span class="p">)</span>
<span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">propagate</span>
<span class="n">an</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmd</span><span class="o">.</span><span class="n">analyze</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyObject &lt;module &#39;fmdtools.analyze&#39; from &#39;c:\\users\\dhulse\\documents\\github\\fmdtools\\fmdtools\\analyze\\__init__.py&#39;&gt;
</pre></div></div>
</div>
<p>Example simulation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">endresult</span><span class="p">,</span><span class="w"> </span><span class="n">mdlhist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">pump_model</span><span class="p">,</span><span class="w"> </span><span class="n">run_stochastic</span><span class="o">=</span><span class="nb">true</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>NOTE: in order for <code class="docutils literal notranslate"><span class="pre">Result.plot_line</span></code> to work correctly, make sure to use the <code class="docutils literal notranslate"><span class="pre">Using</span> <span class="pre">PyCall</span></code> command at the beginning.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s">&quot;fxns.move_water.s.eff&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;fxns.move_water.s.total_flow&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;flows.wat_2.s.flowrate&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;flows.wat_2.s.pressure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_AST_Sampling_14_0.png" src="../../../../_images/._build_html_examples_pump_AST_Sampling_14_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(Figure(PyObject &lt;Figure size 600x400 with 4 Axes&gt;), PyObject[PyObject &lt;Axes: title={&#39;center&#39;: &#39;fxns.move_water.s.eff&#39;}, xlabel=&#39; &#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;fxns.move_water.s.total_flow&#39;}, xlabel=&#39; &#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;flows.wat_2.s.flowrate&#39;}, xlabel=&#39;time&#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;flows.wat_2.s.pressure&#39;}, xlabel=&#39;time&#39;&gt;])
</pre></div></div>
</div>
<section id="AdaStress-Setup">
<h3>AdaStress Setup<a class="headerlink" href="#AdaStress-Setup" title="Permalink to this heading"></a></h3>
<p>Interfacing AdaStress with fmdtools models is enabled by the <code class="docutils literal notranslate"><span class="pre">DynamicProblem</span></code> class in <code class="docutils literal notranslate"><span class="pre">sim.search</span></code> (though this can also be done manually). See below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">DynamicProblem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">DynamicInterface</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyObject &lt;class &#39;fmdtools.sim.search.DynamicInterface&#39;&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DynamicProblem</span><span class="p">(</span><span class="n">pump_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyObject &lt;fmdtools.sim.search.DynamicInterface object at 0x000001FBEA47D7B0&gt;
</pre></div></div>
</div>
<p>Defining the simulation is quite simple with the DynamicProblem class. Note the possible options from this class</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">DynamicProblem</span><span class="o">.</span><span class="n">__init__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

        Initialize the problem.

        Parameters
        ----------
        mdl : Model
            Model defining the simulation.
        mdl_kwargs : dict, optional
            Parameters to run the model at. The default is {}.
        t_max : float, optional
            Maximum simulation time. The default is False.
        track : str/dict, optional
            Properties of the model to track over time. The default is &#34;all&#34;.
        run_stochastic : bool/str, optional
            Whether to run stochastic behaviors (True/False) and/or
            return pdf (&#34;track_pdf&#34;). The default is &#34;track_pdf&#34;.
        desired_result : list, optional
            List of desired results to return at each update. The default is [].
        use_end_condition : bool, optional
            Whether to use model end-condition. The default is None.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Base</span><span class="o">.</span><span class="nd">@kwdef</span><span class="w"> </span><span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">PumpSim</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AdaStress</span><span class="o">.</span><span class="n">BlackBox</span>
<span class="w">    </span><span class="n">sim</span><span class="o">::</span><span class="kt">PyObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DynamicProblem</span><span class="p">(</span><span class="n">pump_model</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PumpSim
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">initialize!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DynamicProblem</span><span class="p">(</span><span class="n">pump_model</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
initialize! (generic function with 1 method)
</pre></div></div>
</div>
<p>Updating is further enabled by DynamicProblem.update</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">DynamicProblem</span><span class="o">.</span><span class="n">update</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

        Update the model states at the simulation time and iterates time.

        Parameters
        ----------
        seed : seed, optional
            Seed for the simulation. The default is {}.
        faults : dict, optional
            faults to inject in the model, with structure {fxn:[faults]}.
            The default is {}.
        disturbances : dict, optional
            Variables to change in the model, with structure {fxn.var:value}.
            The default is {}.

        Returns
        -------
        returns : dict
            dictionary of returns with values corresponding to desired_result

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">update!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span>
<span class="w">    </span><span class="n">seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">1_000_000_000</span><span class="p">)</span>
<span class="w">    </span><span class="n">returns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">returns</span><span class="p">[</span><span class="s">&quot;pdf&quot;</span><span class="p">])</span><span class="w"> </span><span class="c"># note: needs to return a probability from somewhere - needs to be a log pdf?</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
update! (generic function with 1 method)
</pre></div></div>
</div>
<p>Model end-states can be interfaced with using <code class="docutils literal notranslate"><span class="pre">DynamicProblem.check_sim_end</span></code>, which additionally accomodates external conditions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">isterminal!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span>
<span class="w">    </span><span class="n">has_faults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">fxns</span><span class="p">[</span><span class="s">&quot;move_water&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">any_faults</span><span class="p">()</span><span class="w"> </span><span class="c"># our external condition</span>
<span class="w">    </span><span class="n">terminal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">check_sim_end</span><span class="p">(</span><span class="n">external_condition</span><span class="o">=</span><span class="n">has_faults</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">terminal</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
isterminal! (generic function with 1 method)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">isevent!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span>
<span class="w">    </span><span class="n">faults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">fxns</span><span class="p">[</span><span class="s">&quot;move_water&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">any_faults</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">faults</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
isevent! (generic function with 1 method)
</pre></div></div>
</div>
<p>Finally, the below shows the full setup:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">AdaStress</span><span class="o">.</span><span class="n">reset!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initialize!</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">AdaStress</span><span class="o">.</span><span class="n">step!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update!</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">AdaStress</span><span class="o">.</span><span class="n">isterminal</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isterminal!</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">AdaStress</span><span class="o">.</span><span class="n">isevent</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isevent!</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span><span class="w">     </span><span class="c"># difficult: get pressure &gt; 15 ten times</span>
<span class="c"># AdaStress.isevent(sim::PumpSim) = 15.0-sim.mdl.flows[&quot;Wat_1&quot;].pressure &lt;= 0 # - easy: just get pressure &gt; 15 (once!)</span>
<span class="c">#AdaStress.distance(sim::PumpSim) = 15.0-sim.mdl.flows[&quot;Wat_1&quot;].pressure</span>
<span class="n">AdaStress</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">PumpSim</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">float</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">flows</span><span class="o">.</span><span class="n">wat_1</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">pressure</span><span class="o">.&lt;=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Running-AdaStress-Methods">
<h2>Running AdaStress Methods<a class="headerlink" href="#Running-AdaStress-Methods" title="Permalink to this heading"></a></h2>
<p>Monte Carlo Search</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">mcs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">Solvers</span><span class="o">.</span><span class="n">MCS</span><span class="p">(</span><span class="n">num_iterations</span><span class="o">=</span><span class="mi">10_00</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AdaStress.Solvers.MonteCarloSearch.MCS(1000, 10)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">mdp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">ASTMDP</span><span class="p">(</span><span class="n">PumpSim</span><span class="p">())</span>
<span class="n">mdp</span><span class="o">.</span><span class="n">reward</span><span class="o">.</span><span class="n">event_bonus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">200.0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
200.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Random</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mcs</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">mdp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">Progress: 100%|█████████████████████████████████████████| Time: 0:00:37</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataStructures.PriorityQueue{Any, Any, Base.Order.ForwardOrdering} with 10 entries:
  MCSResult(UInt32[0x20a6d935, 0x28bba493, 0xb7b93759, 0xd1a1446c, 0… =&gt; 206.991
  MCSResult(UInt32[0x084541d7, 0x84540de9, 0x7cc282fe, 0x8c04197f, 0… =&gt; 207.019
  MCSResult(UInt32[0x13ad911b, 0xf09a855d, 0x47101ea7, 0x25d57373, 0… =&gt; 208.057
  MCSResult(UInt32[0xef54ffaf, 0x5b752e2b, 0x8940f9fe, 0x87bfa056])   =&gt; 208.121
  MCSResult(UInt32[0xa4fdc8b9, 0xbc7ce3e9, 0x1d17d64d, 0xc72e51ab, 0… =&gt; 208.256
  MCSResult(UInt32[0xfb1a01a1, 0x45b42a6c, 0xdea6badb, 0x49b2b636, 0… =&gt; 209.586
  MCSResult(UInt32[0x10c6c90c, 0xb0192166, 0xd7c40237, 0x6b827ac9, 0… =&gt; 210.216
  MCSResult(UInt32[0x1c031724, 0x22bca5ad, 0xec5453ee, 0x38a2c995, 0… =&gt; 210.228
  MCSResult(UInt32[0x769c9150, 0x211f39ca, 0x8b28f979, 0xb16ab1f2, 0… =&gt; 211.552
  MCSResult(UInt32[0x3ab41a82, 0xcd4d763d, 0x219e185b, 0xca868fbb, 0… =&gt; 213.017
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">mdlhists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sol</span>
<span class="w">    </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">replay!</span><span class="p">(</span><span class="n">mdp</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">)</span>
<span class="w">    </span><span class="n">mdlhists</span><span class="p">[</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;scen&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdp</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">hist</span>
<span class="w">    </span><span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<span class="k">end</span>
<span class="n">mdlhists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmd</span><span class="o">.</span><span class="n">analyze</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">History</span><span class="p">(</span><span class="n">mdlhists</span><span class="p">)</span>
<span class="n">mdlhists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdlhists</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyObject scen1.i.finished:              array(56)
scen1.i.on:                    array(56)
scen1.r.probdens:              array(56)
scen1.flows.ee_1.s.current:    array(56)
scen1.flows.ee_1.s.voltage:    array(56)
scen1.flows.sig_1.s.power:     array(56)
scen1.flows.wat_1.s.flowrate:  array(56)
scen1.flows.wat_1.s.pressure:  array(56)
scen1.flows.wat_1.s.area:      array(56)
scen1.flows.wat_1.s.level:     array(56)
scen1.flows.wat_2.s.flowrate:  array(56)
scen1.flows.wat_2.s.pressure:  array(56)
scen1.flows.wat_2.s.area:      array(56)
scen1.flows.wat_2.s.level:     array(56)
scen1.fxns.import_ee.s.effstate: array(56)
scen1.fxns.import_ee.m.faults.no_v: array(56)
scen1.fxns.import_ee.m.faults.inf_v: array(56)
scen1.fxns.import_ee.r.s.effstate: array(56)
scen1.fxns.import_ee.r.s.grid_noise: array(56)
scen1.fxns.import_ee.r.probdens: array(56)
scen1.fxns.import_wa           array(56)
scen1.fxns.import_wa           array(56)
scen1.fxns.import_si           array(56)
scen1.fxns.import_signal.r.s.sig_noise: array(56)
scen1.fxns.import_signal.r.probdens: array(56)
scen1.fxns.move_water.i.over_pressure: array(56)
scen1.fxns.move_water.s.total_flow: array(56)
scen1.fxns.move_water.s.eff:   array(56)
scen1.fxns.move_wate           array(56)
scen1.fxns.move_water.m.faults.short: array(56)
scen1.fxns.move_water.r.s.eff: array(56)
scen1.fxns.move_water.r.probdens: array(56)
scen1.fxns.move_wate           array(56)
scen1.fxns.move_wate           array(56)
scen1.fxns.export_water.m.faults.block: array(56)
scen1.time:                    array(56)
scen5.i.finished:              array(56)
scen5.i.on:                    array(56)
scen5.r.probdens:              array(56)
scen5.flows.ee_1.s.current:    array(56)
scen5.flows.ee_1.s.voltage:    array(56)
scen5.flows.sig_1.s.power:     array(56)
scen5.flows.wat_1.s.flowrate:  array(56)
scen5.flows.wat_1.s.pressure:  array(56)
scen5.flows.wat_1.s.area:      array(56)
scen5.flows.wat_1.s.level:     array(56)
scen5.flows.wat_2.s.flowrate:  array(56)
scen5.flows.wat_2.s.pressure:  array(56)
scen5.flows.wat_2.s.area:      array(56)
scen5.flows.wat_2.s.level:     array(56)
scen5.fxns.import_ee.s.effstate: array(56)
scen5.fxns.import_ee.m.faults.no_v: array(56)
scen5.fxns.import_ee.m.faults.inf_v: array(56)
scen5.fxns.import_ee.r.s.effstate: array(56)
scen5.fxns.import_ee.r.s.grid_noise: array(56)
scen5.fxns.import_ee.r.probdens: array(56)
scen5.fxns.import_wa           array(56)
scen5.fxns.import_wa           array(56)
scen5.fxns.import_si           array(56)
scen5.fxns.import_signal.r.s.sig_noise: array(56)
scen5.fxns.import_signal.r.probdens: array(56)
scen5.fxns.move_water.i.over_pressure: array(56)
scen5.fxns.move_water.s.total_flow: array(56)
scen5.fxns.move_water.s.eff:   array(56)
scen5.fxns.move_wate           array(56)
scen5.fxns.move_water.m.faults.short: array(56)
scen5.fxns.move_water.r.s.eff: array(56)
scen5.fxns.move_water.r.probdens: array(56)
scen5.fxns.move_wate           array(56)
scen5.fxns.move_wate           array(56)
scen5.fxns.export_water.m.faults.block: array(56)
scen5.time:                    array(56)
scen6.i.finished:              array(56)
scen6.i.on:                    array(56)
scen6.r.probdens:              array(56)
scen6.flows.ee_1.s.current:    array(56)
scen6.flows.ee_1.s.voltage:    array(56)
scen6.flows.sig_1.s.power:     array(56)
scen6.flows.wat_1.s.flowrate:  array(56)
scen6.flows.wat_1.s.pressure:  array(56)
scen6.flows.wat_1.s.area:      array(56)
scen6.flows.wat_1.s.level:     array(56)
scen6.flows.wat_2.s.flowrate:  array(56)
scen6.flows.wat_2.s.pressure:  array(56)
scen6.flows.wat_2.s.area:      array(56)
scen6.flows.wat_2.s.level:     array(56)
scen6.fxns.import_ee.s.effstate: array(56)
scen6.fxns.import_ee.m.faults.no_v: array(56)
scen6.fxns.import_ee.m.faults.inf_v: array(56)
scen6.fxns.import_ee.r.s.effstate: array(56)
scen6.fxns.import_ee.r.s.grid_noise: array(56)
scen6.fxns.import_ee.r.probdens: array(56)
scen6.fxns.import_wa           array(56)
scen6.fxns.import_wa           array(56)
scen6.fxns.import_si           array(56)
scen6.fxns.import_signal.r.s.sig_noise: array(56)
scen6.fxns.import_signal.r.probdens: array(56)
scen6.fxns.move_water.i.over_pressure: array(56)
scen6.fxns.move_water.s.total_flow: array(56)
scen6.fxns.move_water.s.eff:   array(56)
scen6.fxns.move_wate           array(56)
scen6.fxns.move_water.m.faults.short: array(56)
scen6.fxns.move_water.r.s.eff: array(56)
scen6.fxns.move_water.r.probdens: array(56)
scen6.fxns.move_wate           array(56)
scen6.fxns.move_wate           array(56)
scen6.fxns.export_water.m.faults.block: array(56)
scen6.time:                    array(56)
scen3.i.finished:              array(56)
scen3.i.on:                    array(56)
scen3.r.probdens:              array(56)
scen3.flows.ee_1.s.current:    array(56)
scen3.flows.ee_1.s.voltage:    array(56)
scen3.flows.sig_1.s.power:     array(56)
scen3.flows.wat_1.s.flowrate:  array(56)
scen3.flows.wat_1.s.pressure:  array(56)
scen3.flows.wat_1.s.area:      array(56)
scen3.flows.wat_1.s.level:     array(56)
scen3.flows.wat_2.s.flowrate:  array(56)
scen3.flows.wat_2.s.pressure:  array(56)
scen3.flows.wat_2.s.area:      array(56)
scen3.flows.wat_2.s.level:     array(56)
scen3.fxns.import_ee.s.effstate: array(56)
scen3.fxns.import_ee.m.faults.no_v: array(56)
scen3.fxns.import_ee.m.faults.inf_v: array(56)
scen3.fxns.import_ee.r.s.effstate: array(56)
scen3.fxns.import_ee.r.s.grid_noise: array(56)
scen3.fxns.import_ee.r.probdens: array(56)
scen3.fxns.import_wa           array(56)
scen3.fxns.import_wa           array(56)
scen3.fxns.import_si           array(56)
scen3.fxns.import_signal.r.s.sig_noise: array(56)
scen3.fxns.import_signal.r.probdens: array(56)
scen3.fxns.move_water.i.over_pressure: array(56)
scen3.fxns.move_water.s.total_flow: array(56)
scen3.fxns.move_water.s.eff:   array(56)
scen3.fxns.move_wate           array(56)
scen3.fxns.move_water.m.faults.short: array(56)
scen3.fxns.move_water.r.s.eff: array(56)
scen3.fxns.move_water.r.probdens: array(56)
scen3.fxns.move_wate           array(56)
scen3.fxns.move_wate           array(56)
scen3.fxns.export_water.m.faults.block: array(56)
scen3.time:                    array(56)
scen4.i.finished:              array(56)
scen4.i.on:                    array(56)
scen4.r.probdens:              array(56)
scen4.flows.ee_1.s.current:    array(56)
scen4.flows.ee_1.s.voltage:    array(56)
scen4.flows.sig_1.s.power:     array(56)
scen4.flows.wat_1.s.flowrate:  array(56)
scen4.flows.wat_1.s.pressure:  array(56)
scen4.flows.wat_1.s.area:      array(56)
scen4.flows.wat_1.s.level:     array(56)
scen4.flows.wat_2.s.flowrate:  array(56)
scen4.flows.wat_2.s.pressure:  array(56)
scen4.flows.wat_2.s.area:      array(56)
scen4.flows.wat_2.s.level:     array(56)
scen4.fxns.import_ee.s.effstate: array(56)
scen4.fxns.import_ee.m.faults.no_v: array(56)
scen4.fxns.import_ee.m.faults.inf_v: array(56)
scen4.fxns.import_ee.r.s.effstate: array(56)
scen4.fxns.import_ee.r.s.grid_noise: array(56)
scen4.fxns.import_ee.r.probdens: array(56)
scen4.fxns.import_wa           array(56)
scen4.fxns.import_wa           array(56)
scen4.fxns.import_si           array(56)
scen4.fxns.import_signal.r.s.sig_noise: array(56)
scen4.fxns.import_signal.r.probdens: array(56)
scen4.fxns.move_water.i.over_pressure: array(56)
scen4.fxns.move_water.s.total_flow: array(56)
scen4.fxns.move_water.s.eff:   array(56)
scen4.fxns.move_wate           array(56)
scen4.fxns.move_water.m.faults.short: array(56)
scen4.fxns.move_water.r.s.eff: array(56)
scen4.fxns.move_water.r.probdens: array(56)
scen4.fxns.move_wate           array(56)
scen4.fxns.move_wate           array(56)
scen4.fxns.export_water.m.faults.block: array(56)
scen4.time:                    array(56)
scen0.i.finished:              array(56)
scen0.i.on:                    array(56)
scen0.r.probdens:              array(56)
scen0.flows.ee_1.s.current:    array(56)
scen0.flows.ee_1.s.voltage:    array(56)
scen0.flows.sig_1.s.power:     array(56)
scen0.flows.wat_1.s.flowrate:  array(56)
scen0.flows.wat_1.s.pressure:  array(56)
scen0.flows.wat_1.s.area:      array(56)
scen0.flows.wat_1.s.level:     array(56)
scen0.flows.wat_2.s.flowrate:  array(56)
scen0.flows.wat_2.s.pressure:  array(56)
scen0.flows.wat_2.s.area:      array(56)
scen0.flows.wat_2.s.level:     array(56)
scen0.fxns.import_ee.s.effstate: array(56)
scen0.fxns.import_ee.m.faults.no_v: array(56)
scen0.fxns.import_ee.m.faults.inf_v: array(56)
scen0.fxns.import_ee.r.s.effstate: array(56)
scen0.fxns.import_ee.r.s.grid_noise: array(56)
scen0.fxns.import_ee.r.probdens: array(56)
scen0.fxns.import_wa           array(56)
scen0.fxns.import_wa           array(56)
scen0.fxns.import_si           array(56)
scen0.fxns.import_signal.r.s.sig_noise: array(56)
scen0.fxns.import_signal.r.probdens: array(56)
scen0.fxns.move_water.i.over_pressure: array(56)
scen0.fxns.move_water.s.total_flow: array(56)
scen0.fxns.move_water.s.eff:   array(56)
scen0.fxns.move_wate           array(56)
scen0.fxns.move_water.m.faults.short: array(56)
scen0.fxns.move_water.r.s.eff: array(56)
scen0.fxns.move_water.r.probdens: array(56)
scen0.fxns.move_wate           array(56)
scen0.fxns.move_wate           array(56)
scen0.fxns.export_water.m.faults.block: array(56)
scen0.time:                    array(56)
scen2.i.finished:              array(56)
scen2.i.on:                    array(56)
scen2.r.probdens:              array(56)
scen2.flows.ee_1.s.current:    array(56)
scen2.flows.ee_1.s.voltage:    array(56)
scen2.flows.sig_1.s.power:     array(56)
scen2.flows.wat_1.s.flowrate:  array(56)
scen2.flows.wat_1.s.pressure:  array(56)
scen2.flows.wat_1.s.area:      array(56)
scen2.flows.wat_1.s.level:     array(56)
scen2.flows.wat_2.s.flowrate:  array(56)
scen2.flows.wat_2.s.pressure:  array(56)
scen2.flows.wat_2.s.area:      array(56)
scen2.flows.wat_2.s.level:     array(56)
scen2.fxns.import_ee.s.effstate: array(56)
scen2.fxns.import_ee.m.faults.no_v: array(56)
scen2.fxns.import_ee.m.faults.inf_v: array(56)
scen2.fxns.import_ee.r.s.effstate: array(56)
scen2.fxns.import_ee.r.s.grid_noise: array(56)
scen2.fxns.import_ee.r.probdens: array(56)
scen2.fxns.import_wa           array(56)
scen2.fxns.import_wa           array(56)
scen2.fxns.import_si           array(56)
scen2.fxns.import_signal.r.s.sig_noise: array(56)
scen2.fxns.import_signal.r.probdens: array(56)
scen2.fxns.move_water.i.over_pressure: array(56)
scen2.fxns.move_water.s.total_flow: array(56)
scen2.fxns.move_water.s.eff:   array(56)
scen2.fxns.move_wate           array(56)
scen2.fxns.move_water.m.faults.short: array(56)
scen2.fxns.move_water.r.s.eff: array(56)
scen2.fxns.move_water.r.probdens: array(56)
scen2.fxns.move_wate           array(56)
scen2.fxns.move_wate           array(56)
scen2.fxns.export_water.m.faults.block: array(56)
scen2.time:                    array(56)
scen9.i.finished:              array(56)
scen9.i.on:                    array(56)
scen9.r.probdens:              array(56)
scen9.flows.ee_1.s.current:    array(56)
scen9.flows.ee_1.s.voltage:    array(56)
scen9.flows.sig_1.s.power:     array(56)
scen9.flows.wat_1.s.flowrate:  array(56)
scen9.flows.wat_1.s.pressure:  array(56)
scen9.flows.wat_1.s.area:      array(56)
scen9.flows.wat_1.s.level:     array(56)
scen9.flows.wat_2.s.flowrate:  array(56)
scen9.flows.wat_2.s.pressure:  array(56)
scen9.flows.wat_2.s.area:      array(56)
scen9.flows.wat_2.s.level:     array(56)
scen9.fxns.import_ee.s.effstate: array(56)
scen9.fxns.import_ee.m.faults.no_v: array(56)
scen9.fxns.import_ee.m.faults.inf_v: array(56)
scen9.fxns.import_ee.r.s.effstate: array(56)
scen9.fxns.import_ee.r.s.grid_noise: array(56)
scen9.fxns.import_ee.r.probdens: array(56)
scen9.fxns.import_wa           array(56)
scen9.fxns.import_wa           array(56)
scen9.fxns.import_si           array(56)
scen9.fxns.import_signal.r.s.sig_noise: array(56)
scen9.fxns.import_signal.r.probdens: array(56)
scen9.fxns.move_water.i.over_pressure: array(56)
scen9.fxns.move_water.s.total_flow: array(56)
scen9.fxns.move_water.s.eff:   array(56)
scen9.fxns.move_wate           array(56)
scen9.fxns.move_water.m.faults.short: array(56)
scen9.fxns.move_water.r.s.eff: array(56)
scen9.fxns.move_water.r.probdens: array(56)
scen9.fxns.move_wate           array(56)
scen9.fxns.move_wate           array(56)
scen9.fxns.export_water.m.faults.block: array(56)
scen9.time:                    array(56)
scen8.i.finished:              array(56)
scen8.i.on:                    array(56)
scen8.r.probdens:              array(56)
scen8.flows.ee_1.s.current:    array(56)
scen8.flows.ee_1.s.voltage:    array(56)
scen8.flows.sig_1.s.power:     array(56)
scen8.flows.wat_1.s.flowrate:  array(56)
scen8.flows.wat_1.s.pressure:  array(56)
scen8.flows.wat_1.s.area:      array(56)
scen8.flows.wat_1.s.level:     array(56)
scen8.flows.wat_2.s.flowrate:  array(56)
scen8.flows.wat_2.s.pressure:  array(56)
scen8.flows.wat_2.s.area:      array(56)
scen8.flows.wat_2.s.level:     array(56)
scen8.fxns.import_ee.s.effstate: array(56)
scen8.fxns.import_ee.m.faults.no_v: array(56)
scen8.fxns.import_ee.m.faults.inf_v: array(56)
scen8.fxns.import_ee.r.s.effstate: array(56)
scen8.fxns.import_ee.r.s.grid_noise: array(56)
scen8.fxns.import_ee.r.probdens: array(56)
scen8.fxns.import_wa           array(56)
scen8.fxns.import_wa           array(56)
scen8.fxns.import_si           array(56)
scen8.fxns.import_signal.r.s.sig_noise: array(56)
scen8.fxns.import_signal.r.probdens: array(56)
scen8.fxns.move_water.i.over_pressure: array(56)
scen8.fxns.move_water.s.total_flow: array(56)
scen8.fxns.move_water.s.eff:   array(56)
scen8.fxns.move_wate           array(56)
scen8.fxns.move_water.m.faults.short: array(56)
scen8.fxns.move_water.r.s.eff: array(56)
scen8.fxns.move_water.r.probdens: array(56)
scen8.fxns.move_wate           array(56)
scen8.fxns.move_wate           array(56)
scen8.fxns.export_water.m.faults.block: array(56)
scen8.time:                    array(56)
scen7.i.finished:              array(56)
scen7.i.on:                    array(56)
scen7.r.probdens:              array(56)
scen7.flows.ee_1.s.current:    array(56)
scen7.flows.ee_1.s.voltage:    array(56)
scen7.flows.sig_1.s.power:     array(56)
scen7.flows.wat_1.s.flowrate:  array(56)
scen7.flows.wat_1.s.pressure:  array(56)
scen7.flows.wat_1.s.area:      array(56)
scen7.flows.wat_1.s.level:     array(56)
scen7.flows.wat_2.s.flowrate:  array(56)
scen7.flows.wat_2.s.pressure:  array(56)
scen7.flows.wat_2.s.area:      array(56)
scen7.flows.wat_2.s.level:     array(56)
scen7.fxns.import_ee.s.effstate: array(56)
scen7.fxns.import_ee.m.faults.no_v: array(56)
scen7.fxns.import_ee.m.faults.inf_v: array(56)
scen7.fxns.import_ee.r.s.effstate: array(56)
scen7.fxns.import_ee.r.s.grid_noise: array(56)
scen7.fxns.import_ee.r.probdens: array(56)
scen7.fxns.import_wa           array(56)
scen7.fxns.import_wa           array(56)
scen7.fxns.import_si           array(56)
scen7.fxns.import_signal.r.s.sig_noise: array(56)
scen7.fxns.import_signal.r.probdens: array(56)
scen7.fxns.move_water.i.over_pressure: array(56)
scen7.fxns.move_water.s.total_flow: array(56)
scen7.fxns.move_water.s.eff:   array(56)
scen7.fxns.move_wate           array(56)
scen7.fxns.move_water.m.faults.short: array(56)
scen7.fxns.move_water.r.s.eff: array(56)
scen7.fxns.move_water.r.probdens: array(56)
scen7.fxns.move_wate           array(56)
scen7.fxns.move_wate           array(56)
scen7.fxns.export_water.m.faults.block: array(56)
scen7.time:                    array(56)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">mdlhists</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s">&quot;fxns.move_water.s.eff&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="s">&quot;fxns.move_water.s.total_flow&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="s">&quot;flows.wat_2.s.flowrate&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="s">&quot;flows.wat_2.s.pressure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_AST_Sampling_36_0.png" src="../../../../_images/._build_html_examples_pump_AST_Sampling_36_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(Figure(PyObject &lt;Figure size 600x400 with 4 Axes&gt;), PyObject[PyObject &lt;Axes: title={&#39;center&#39;: &#39;fxns.move_water.s.eff&#39;}, xlabel=&#39; &#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;fxns.move_water.s.total_flow&#39;}, xlabel=&#39; &#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;flows.wat_2.s.flowrate&#39;}, xlabel=&#39;time&#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;flows.wat_2.s.pressure&#39;}, xlabel=&#39;time&#39;&gt;])
</pre></div></div>
</div>
</section>
<section id="MCTS">
<h2>MCTS<a class="headerlink" href="#MCTS" title="Permalink to this heading"></a></h2>
<p>Monte Carlo Tree Search</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">mcts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">Solvers</span><span class="o">.</span><span class="n">MCTS</span><span class="p">(</span><span class="n">num_iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AdaStress.Solvers.MonteCarloTreeSearch.MCTS(1000, 10, 1.0, 0.7, 1.0, nothing)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@time</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mcts</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">mdp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">Progress: 100%|█████████████████████████████████████████| Time: 0:00:14</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 14.751713 seconds (5.93 M allocations: 283.844 MiB, 0.48% gc time, 2.24% compilation time)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataStructures.PriorityQueue{Any, Any, Base.Order.ForwardOrdering} with 10 entries:
  MCTSResult(UInt32[0x828d83bf, 0x569a8b4b, 0x42db7247, 0x860d2412])  =&gt; 203.112
  MCTSResult(UInt32[0x9be7bec6, 0xa281bfa4, 0xa911ec3d])              =&gt; 203.12
  MCTSResult(UInt32[0x9be7bec6, 0xd34fd93a, 0x6bc04b0b])              =&gt; 203.151
  MCTSResult(UInt32[0xfd5b9189, 0xe6ed8348, 0x53813216])              =&gt; 203.248
  MCTSResult(UInt32[0x77d94185, 0x0593823c, 0xe2a9136a, 0x16e247bc, … =&gt; 203.706
  MCTSResult(UInt32[0x48cea00e, 0x5e5903be, 0x40184882, 0x11abadd6, … =&gt; 204.454
  MCTSResult(UInt32[0xe04f8a60, 0xff8d3670, 0x5846f74e, 0xd2c176d0, … =&gt; 204.516
  MCTSResult(UInt32[0x76bdd112, 0x40fc08c9, 0x7151eb1c, 0x25a0e9a5, … =&gt; 204.932
  MCTSResult(UInt32[0xc72f45c9, 0x2a4519ab, 0x52413abb])              =&gt; 205.292
  MCTSResult(UInt32[0x57387aea, 0xaf5383c3, 0x43d34d08, 0x1720253e, … =&gt; 206.777
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">mdlhists2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sol</span>
<span class="w">    </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">replay!</span><span class="p">(</span><span class="n">mdp</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">)</span>
<span class="w">    </span><span class="n">mdlhists2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdp</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">hist</span>
<span class="w">    </span><span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<span class="k">end</span>
<span class="n">mdlhists2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmd</span><span class="o">.</span><span class="n">analyze</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">History</span><span class="p">(</span><span class="n">mdlhists2</span><span class="p">)</span>
<span class="n">mdlhists2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdlhists2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyObject t0.i.finished:                 array(56)
t0.i.on:                       array(56)
t0.r.probdens:                 array(56)
t0.flows.ee_1.s.current:       array(56)
t0.flows.ee_1.s.voltage:       array(56)
t0.flows.sig_1.s.power:        array(56)
t0.flows.wat_1.s.flowrate:     array(56)
t0.flows.wat_1.s.pressure:     array(56)
t0.flows.wat_1.s.area:         array(56)
t0.flows.wat_1.s.level:        array(56)
t0.flows.wat_2.s.flowrate:     array(56)
t0.flows.wat_2.s.pressure:     array(56)
t0.flows.wat_2.s.area:         array(56)
t0.flows.wat_2.s.level:        array(56)
t0.fxns.import_ee.s.effstate:  array(56)
t0.fxns.import_ee.m.faults.no_v: array(56)
t0.fxns.import_ee.m.faults.inf_v: array(56)
t0.fxns.import_ee.r.s.effstate: array(56)
t0.fxns.import_ee.r.s.grid_noise: array(56)
t0.fxns.import_ee.r.probdens:  array(56)
t0.fxns.import_water.m.faults.no_wat: array(56)
t0.fxns.import_water.m.faults.less_wat: array(56)
t0.fxns.import_signal.m.faults.no_sig: array(56)
t0.fxns.import_signal.r.s.sig_noise: array(56)
t0.fxns.import_signal.r.probdens: array(56)
t0.fxns.move_water.i.over_pressure: array(56)
t0.fxns.move_water.s.total_flow: array(56)
t0.fxns.move_water.s.eff:      array(56)
t0.fxns.move_water.m.faults.mech_break: array(56)
t0.fxns.move_water.m.faults.short: array(56)
t0.fxns.move_water.r.s.eff:    array(56)
t0.fxns.move_water.r.probdens: array(56)
t0.fxns.move_water.t           array(56)
t0.fxns.move_water.t           array(56)
t0.fxns.export_water.m.faults.block: array(56)
t0.time:                       array(56)
t4.i.finished:                 array(56)
t4.i.on:                       array(56)
t4.r.probdens:                 array(56)
t4.flows.ee_1.s.current:       array(56)
t4.flows.ee_1.s.voltage:       array(56)
t4.flows.sig_1.s.power:        array(56)
t4.flows.wat_1.s.flowrate:     array(56)
t4.flows.wat_1.s.pressure:     array(56)
t4.flows.wat_1.s.area:         array(56)
t4.flows.wat_1.s.level:        array(56)
t4.flows.wat_2.s.flowrate:     array(56)
t4.flows.wat_2.s.pressure:     array(56)
t4.flows.wat_2.s.area:         array(56)
t4.flows.wat_2.s.level:        array(56)
t4.fxns.import_ee.s.effstate:  array(56)
t4.fxns.import_ee.m.faults.no_v: array(56)
t4.fxns.import_ee.m.faults.inf_v: array(56)
t4.fxns.import_ee.r.s.effstate: array(56)
t4.fxns.import_ee.r.s.grid_noise: array(56)
t4.fxns.import_ee.r.probdens:  array(56)
t4.fxns.import_water.m.faults.no_wat: array(56)
t4.fxns.import_water.m.faults.less_wat: array(56)
t4.fxns.import_signal.m.faults.no_sig: array(56)
t4.fxns.import_signal.r.s.sig_noise: array(56)
t4.fxns.import_signal.r.probdens: array(56)
t4.fxns.move_water.i.over_pressure: array(56)
t4.fxns.move_water.s.total_flow: array(56)
t4.fxns.move_water.s.eff:      array(56)
t4.fxns.move_water.m.faults.mech_break: array(56)
t4.fxns.move_water.m.faults.short: array(56)
t4.fxns.move_water.r.s.eff:    array(56)
t4.fxns.move_water.r.probdens: array(56)
t4.fxns.move_water.t           array(56)
t4.fxns.move_water.t           array(56)
t4.fxns.export_water.m.faults.block: array(56)
t4.time:                       array(56)
t5.i.finished:                 array(56)
t5.i.on:                       array(56)
t5.r.probdens:                 array(56)
t5.flows.ee_1.s.current:       array(56)
t5.flows.ee_1.s.voltage:       array(56)
t5.flows.sig_1.s.power:        array(56)
t5.flows.wat_1.s.flowrate:     array(56)
t5.flows.wat_1.s.pressure:     array(56)
t5.flows.wat_1.s.area:         array(56)
t5.flows.wat_1.s.level:        array(56)
t5.flows.wat_2.s.flowrate:     array(56)
t5.flows.wat_2.s.pressure:     array(56)
t5.flows.wat_2.s.area:         array(56)
t5.flows.wat_2.s.level:        array(56)
t5.fxns.import_ee.s.effstate:  array(56)
t5.fxns.import_ee.m.faults.no_v: array(56)
t5.fxns.import_ee.m.faults.inf_v: array(56)
t5.fxns.import_ee.r.s.effstate: array(56)
t5.fxns.import_ee.r.s.grid_noise: array(56)
t5.fxns.import_ee.r.probdens:  array(56)
t5.fxns.import_water.m.faults.no_wat: array(56)
t5.fxns.import_water.m.faults.less_wat: array(56)
t5.fxns.import_signal.m.faults.no_sig: array(56)
t5.fxns.import_signal.r.s.sig_noise: array(56)
t5.fxns.import_signal.r.probdens: array(56)
t5.fxns.move_water.i.over_pressure: array(56)
t5.fxns.move_water.s.total_flow: array(56)
t5.fxns.move_water.s.eff:      array(56)
t5.fxns.move_water.m.faults.mech_break: array(56)
t5.fxns.move_water.m.faults.short: array(56)
t5.fxns.move_water.r.s.eff:    array(56)
t5.fxns.move_water.r.probdens: array(56)
t5.fxns.move_water.t           array(56)
t5.fxns.move_water.t           array(56)
t5.fxns.export_water.m.faults.block: array(56)
t5.time:                       array(56)
t6.i.finished:                 array(56)
t6.i.on:                       array(56)
t6.r.probdens:                 array(56)
t6.flows.ee_1.s.current:       array(56)
t6.flows.ee_1.s.voltage:       array(56)
t6.flows.sig_1.s.power:        array(56)
t6.flows.wat_1.s.flowrate:     array(56)
t6.flows.wat_1.s.pressure:     array(56)
t6.flows.wat_1.s.area:         array(56)
t6.flows.wat_1.s.level:        array(56)
t6.flows.wat_2.s.flowrate:     array(56)
t6.flows.wat_2.s.pressure:     array(56)
t6.flows.wat_2.s.area:         array(56)
t6.flows.wat_2.s.level:        array(56)
t6.fxns.import_ee.s.effstate:  array(56)
t6.fxns.import_ee.m.faults.no_v: array(56)
t6.fxns.import_ee.m.faults.inf_v: array(56)
t6.fxns.import_ee.r.s.effstate: array(56)
t6.fxns.import_ee.r.s.grid_noise: array(56)
t6.fxns.import_ee.r.probdens:  array(56)
t6.fxns.import_water.m.faults.no_wat: array(56)
t6.fxns.import_water.m.faults.less_wat: array(56)
t6.fxns.import_signal.m.faults.no_sig: array(56)
t6.fxns.import_signal.r.s.sig_noise: array(56)
t6.fxns.import_signal.r.probdens: array(56)
t6.fxns.move_water.i.over_pressure: array(56)
t6.fxns.move_water.s.total_flow: array(56)
t6.fxns.move_water.s.eff:      array(56)
t6.fxns.move_water.m.faults.mech_break: array(56)
t6.fxns.move_water.m.faults.short: array(56)
t6.fxns.move_water.r.s.eff:    array(56)
t6.fxns.move_water.r.probdens: array(56)
t6.fxns.move_water.t           array(56)
t6.fxns.move_water.t           array(56)
t6.fxns.export_water.m.faults.block: array(56)
t6.time:                       array(56)
t2.i.finished:                 array(56)
t2.i.on:                       array(56)
t2.r.probdens:                 array(56)
t2.flows.ee_1.s.current:       array(56)
t2.flows.ee_1.s.voltage:       array(56)
t2.flows.sig_1.s.power:        array(56)
t2.flows.wat_1.s.flowrate:     array(56)
t2.flows.wat_1.s.pressure:     array(56)
t2.flows.wat_1.s.area:         array(56)
t2.flows.wat_1.s.level:        array(56)
t2.flows.wat_2.s.flowrate:     array(56)
t2.flows.wat_2.s.pressure:     array(56)
t2.flows.wat_2.s.area:         array(56)
t2.flows.wat_2.s.level:        array(56)
t2.fxns.import_ee.s.effstate:  array(56)
t2.fxns.import_ee.m.faults.no_v: array(56)
t2.fxns.import_ee.m.faults.inf_v: array(56)
t2.fxns.import_ee.r.s.effstate: array(56)
t2.fxns.import_ee.r.s.grid_noise: array(56)
t2.fxns.import_ee.r.probdens:  array(56)
t2.fxns.import_water.m.faults.no_wat: array(56)
t2.fxns.import_water.m.faults.less_wat: array(56)
t2.fxns.import_signal.m.faults.no_sig: array(56)
t2.fxns.import_signal.r.s.sig_noise: array(56)
t2.fxns.import_signal.r.probdens: array(56)
t2.fxns.move_water.i.over_pressure: array(56)
t2.fxns.move_water.s.total_flow: array(56)
t2.fxns.move_water.s.eff:      array(56)
t2.fxns.move_water.m.faults.mech_break: array(56)
t2.fxns.move_water.m.faults.short: array(56)
t2.fxns.move_water.r.s.eff:    array(56)
t2.fxns.move_water.r.probdens: array(56)
t2.fxns.move_water.t           array(56)
t2.fxns.move_water.t           array(56)
t2.fxns.export_water.m.faults.block: array(56)
t2.time:                       array(56)
t7.i.finished:                 array(56)
t7.i.on:                       array(56)
t7.r.probdens:                 array(56)
t7.flows.ee_1.s.current:       array(56)
t7.flows.ee_1.s.voltage:       array(56)
t7.flows.sig_1.s.power:        array(56)
t7.flows.wat_1.s.flowrate:     array(56)
t7.flows.wat_1.s.pressure:     array(56)
t7.flows.wat_1.s.area:         array(56)
t7.flows.wat_1.s.level:        array(56)
t7.flows.wat_2.s.flowrate:     array(56)
t7.flows.wat_2.s.pressure:     array(56)
t7.flows.wat_2.s.area:         array(56)
t7.flows.wat_2.s.level:        array(56)
t7.fxns.import_ee.s.effstate:  array(56)
t7.fxns.import_ee.m.faults.no_v: array(56)
t7.fxns.import_ee.m.faults.inf_v: array(56)
t7.fxns.import_ee.r.s.effstate: array(56)
t7.fxns.import_ee.r.s.grid_noise: array(56)
t7.fxns.import_ee.r.probdens:  array(56)
t7.fxns.import_water.m.faults.no_wat: array(56)
t7.fxns.import_water.m.faults.less_wat: array(56)
t7.fxns.import_signal.m.faults.no_sig: array(56)
t7.fxns.import_signal.r.s.sig_noise: array(56)
t7.fxns.import_signal.r.probdens: array(56)
t7.fxns.move_water.i.over_pressure: array(56)
t7.fxns.move_water.s.total_flow: array(56)
t7.fxns.move_water.s.eff:      array(56)
t7.fxns.move_water.m.faults.mech_break: array(56)
t7.fxns.move_water.m.faults.short: array(56)
t7.fxns.move_water.r.s.eff:    array(56)
t7.fxns.move_water.r.probdens: array(56)
t7.fxns.move_water.t           array(56)
t7.fxns.move_water.t           array(56)
t7.fxns.export_water.m.faults.block: array(56)
t7.time:                       array(56)
t9.i.finished:                 array(56)
t9.i.on:                       array(56)
t9.r.probdens:                 array(56)
t9.flows.ee_1.s.current:       array(56)
t9.flows.ee_1.s.voltage:       array(56)
t9.flows.sig_1.s.power:        array(56)
t9.flows.wat_1.s.flowrate:     array(56)
t9.flows.wat_1.s.pressure:     array(56)
t9.flows.wat_1.s.area:         array(56)
t9.flows.wat_1.s.level:        array(56)
t9.flows.wat_2.s.flowrate:     array(56)
t9.flows.wat_2.s.pressure:     array(56)
t9.flows.wat_2.s.area:         array(56)
t9.flows.wat_2.s.level:        array(56)
t9.fxns.import_ee.s.effstate:  array(56)
t9.fxns.import_ee.m.faults.no_v: array(56)
t9.fxns.import_ee.m.faults.inf_v: array(56)
t9.fxns.import_ee.r.s.effstate: array(56)
t9.fxns.import_ee.r.s.grid_noise: array(56)
t9.fxns.import_ee.r.probdens:  array(56)
t9.fxns.import_water.m.faults.no_wat: array(56)
t9.fxns.import_water.m.faults.less_wat: array(56)
t9.fxns.import_signal.m.faults.no_sig: array(56)
t9.fxns.import_signal.r.s.sig_noise: array(56)
t9.fxns.import_signal.r.probdens: array(56)
t9.fxns.move_water.i.over_pressure: array(56)
t9.fxns.move_water.s.total_flow: array(56)
t9.fxns.move_water.s.eff:      array(56)
t9.fxns.move_water.m.faults.mech_break: array(56)
t9.fxns.move_water.m.faults.short: array(56)
t9.fxns.move_water.r.s.eff:    array(56)
t9.fxns.move_water.r.probdens: array(56)
t9.fxns.move_water.t           array(56)
t9.fxns.move_water.t           array(56)
t9.fxns.export_water.m.faults.block: array(56)
t9.time:                       array(56)
t8.i.finished:                 array(56)
t8.i.on:                       array(56)
t8.r.probdens:                 array(56)
t8.flows.ee_1.s.current:       array(56)
t8.flows.ee_1.s.voltage:       array(56)
t8.flows.sig_1.s.power:        array(56)
t8.flows.wat_1.s.flowrate:     array(56)
t8.flows.wat_1.s.pressure:     array(56)
t8.flows.wat_1.s.area:         array(56)
t8.flows.wat_1.s.level:        array(56)
t8.flows.wat_2.s.flowrate:     array(56)
t8.flows.wat_2.s.pressure:     array(56)
t8.flows.wat_2.s.area:         array(56)
t8.flows.wat_2.s.level:        array(56)
t8.fxns.import_ee.s.effstate:  array(56)
t8.fxns.import_ee.m.faults.no_v: array(56)
t8.fxns.import_ee.m.faults.inf_v: array(56)
t8.fxns.import_ee.r.s.effstate: array(56)
t8.fxns.import_ee.r.s.grid_noise: array(56)
t8.fxns.import_ee.r.probdens:  array(56)
t8.fxns.import_water.m.faults.no_wat: array(56)
t8.fxns.import_water.m.faults.less_wat: array(56)
t8.fxns.import_signal.m.faults.no_sig: array(56)
t8.fxns.import_signal.r.s.sig_noise: array(56)
t8.fxns.import_signal.r.probdens: array(56)
t8.fxns.move_water.i.over_pressure: array(56)
t8.fxns.move_water.s.total_flow: array(56)
t8.fxns.move_water.s.eff:      array(56)
t8.fxns.move_water.m.faults.mech_break: array(56)
t8.fxns.move_water.m.faults.short: array(56)
t8.fxns.move_water.r.s.eff:    array(56)
t8.fxns.move_water.r.probdens: array(56)
t8.fxns.move_water.t           array(56)
t8.fxns.move_water.t           array(56)
t8.fxns.export_water.m.faults.block: array(56)
t8.time:                       array(56)
t3.i.finished:                 array(56)
t3.i.on:                       array(56)
t3.r.probdens:                 array(56)
t3.flows.ee_1.s.current:       array(56)
t3.flows.ee_1.s.voltage:       array(56)
t3.flows.sig_1.s.power:        array(56)
t3.flows.wat_1.s.flowrate:     array(56)
t3.flows.wat_1.s.pressure:     array(56)
t3.flows.wat_1.s.area:         array(56)
t3.flows.wat_1.s.level:        array(56)
t3.flows.wat_2.s.flowrate:     array(56)
t3.flows.wat_2.s.pressure:     array(56)
t3.flows.wat_2.s.area:         array(56)
t3.flows.wat_2.s.level:        array(56)
t3.fxns.import_ee.s.effstate:  array(56)
t3.fxns.import_ee.m.faults.no_v: array(56)
t3.fxns.import_ee.m.faults.inf_v: array(56)
t3.fxns.import_ee.r.s.effstate: array(56)
t3.fxns.import_ee.r.s.grid_noise: array(56)
t3.fxns.import_ee.r.probdens:  array(56)
t3.fxns.import_water.m.faults.no_wat: array(56)
t3.fxns.import_water.m.faults.less_wat: array(56)
t3.fxns.import_signal.m.faults.no_sig: array(56)
t3.fxns.import_signal.r.s.sig_noise: array(56)
t3.fxns.import_signal.r.probdens: array(56)
t3.fxns.move_water.i.over_pressure: array(56)
t3.fxns.move_water.s.total_flow: array(56)
t3.fxns.move_water.s.eff:      array(56)
t3.fxns.move_water.m.faults.mech_break: array(56)
t3.fxns.move_water.m.faults.short: array(56)
t3.fxns.move_water.r.s.eff:    array(56)
t3.fxns.move_water.r.probdens: array(56)
t3.fxns.move_water.t           array(56)
t3.fxns.move_water.t           array(56)
t3.fxns.export_water.m.faults.block: array(56)
t3.time:                       array(56)
t1.i.finished:                 array(56)
t1.i.on:                       array(56)
t1.r.probdens:                 array(56)
t1.flows.ee_1.s.current:       array(56)
t1.flows.ee_1.s.voltage:       array(56)
t1.flows.sig_1.s.power:        array(56)
t1.flows.wat_1.s.flowrate:     array(56)
t1.flows.wat_1.s.pressure:     array(56)
t1.flows.wat_1.s.area:         array(56)
t1.flows.wat_1.s.level:        array(56)
t1.flows.wat_2.s.flowrate:     array(56)
t1.flows.wat_2.s.pressure:     array(56)
t1.flows.wat_2.s.area:         array(56)
t1.flows.wat_2.s.level:        array(56)
t1.fxns.import_ee.s.effstate:  array(56)
t1.fxns.import_ee.m.faults.no_v: array(56)
t1.fxns.import_ee.m.faults.inf_v: array(56)
t1.fxns.import_ee.r.s.effstate: array(56)
t1.fxns.import_ee.r.s.grid_noise: array(56)
t1.fxns.import_ee.r.probdens:  array(56)
t1.fxns.import_water.m.faults.no_wat: array(56)
t1.fxns.import_water.m.faults.less_wat: array(56)
t1.fxns.import_signal.m.faults.no_sig: array(56)
t1.fxns.import_signal.r.s.sig_noise: array(56)
t1.fxns.import_signal.r.probdens: array(56)
t1.fxns.move_water.i.over_pressure: array(56)
t1.fxns.move_water.s.total_flow: array(56)
t1.fxns.move_water.s.eff:      array(56)
t1.fxns.move_water.m.faults.mech_break: array(56)
t1.fxns.move_water.m.faults.short: array(56)
t1.fxns.move_water.r.s.eff:    array(56)
t1.fxns.move_water.r.probdens: array(56)
t1.fxns.move_water.t           array(56)
t1.fxns.move_water.t           array(56)
t1.fxns.export_water.m.faults.block: array(56)
t1.time:                       array(56)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">axs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdlhists2</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s">&quot;fxns.move_water.s.eff&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fxns.move_water.s.total_flow&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;flows.wat_2.s.flowrate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;flows.wat_2.s.pressure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_AST_Sampling_41_0.png" src="../../../../_images/._build_html_examples_pump_AST_Sampling_41_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(Figure(PyObject &lt;Figure size 600x400 with 4 Axes&gt;), PyObject[PyObject &lt;Axes: title={&#39;center&#39;: &#39;fxns.move_water.s.eff&#39;}, xlabel=&#39; &#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;fxns.move_water.s.total_flow&#39;}, xlabel=&#39; &#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;flows.wat_2.s.flowrate&#39;}, xlabel=&#39;time&#39;&gt;, PyObject &lt;Axes: title={&#39;center&#39;: &#39;flows.wat_2.s.pressure&#39;}, xlabel=&#39;time&#39;&gt;])
</pre></div></div>
</div>
<p>As we can see, MCTS finds more breakage faults (8 instead of 3), as a result of being a more informed search method.</p>
<section id="Grey-Box-Methods">
<h3>Grey Box Methods<a class="headerlink" href="#Grey-Box-Methods" title="Permalink to this heading"></a></h3>
<p>As opposed to black box methods, which share no information about the system state with the agent, grey box methods let the agent sample the random distributions and pass disturbances to the model directly, rather than just passing seeds.</p>
<p>Implementation is based off of: <a class="reference external" href="https://github.com/NASA-SW-VnV/AdaStress.jl/blob/master/examples/walk2d/walk2d.ipynb">https://github.com/NASA-SW-VnV/AdaStress.jl/blob/master/examples/walk2d/walk2d.ipynb</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">AdaStress</span>
<span class="k">import</span><span class="w"> </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">GrayBox</span>
<span class="k">using</span><span class="w"> </span><span class="n">Distributions</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Pump">
<h2>Pump<a class="headerlink" href="#Pump" title="Permalink to this heading"></a></h2>
<p>To use the gray box method, we have to first define which variables in the model to sample/update. fmdtools models have two types of random states: - general random states, which are updated in the behavioral method (whose distributions thus cannot be accessed without looking at the code) - auto-updating random states, which are updated from a given distribution defined with auto_update=(dist,params). These distributions can be accessed directly from the model.</p>
<p>Both can be queried in AdaStress, but using different methods. In general, however, using a Gray Box method means that <em>all</em> stochastic behavior (desired by the analysis) should be represented in AdaStress/Julia, since integration relies on running the model as deterministic.</p>
<p>Below are the random states of the model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">rand_states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pump_model</span><span class="o">.</span><span class="n">get_rand_states</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dict{Any, Any} with 3 entries:
  &#34;move_water&#34;    =&gt; Dict{Any, Any}(&#34;eff&#34;=&gt;1.0)
  &#34;import_signal&#34; =&gt; Dict{Any, Any}(&#34;sig_noise&#34;=&gt;1.0)
  &#34;import_ee&#34;     =&gt; Dict{Any, Any}(&#34;effstate&#34;=&gt;1.0, &#34;grid_noise&#34;=&gt;1.0)
</pre></div></div>
</div>
<p>As well as the auto-updating random states:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">rand_states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pump_model</span><span class="o">.</span><span class="n">get_rand_states</span><span class="p">(</span><span class="n">auto_update_only</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dict{Any, Any} with 1 entry:
  &#34;move_water&#34; =&gt; Dict{Any, Any}(&#34;eff&#34;=&gt;1.0)
</pre></div></div>
</div>
</section>
<section id="Simulator">
<h2>Simulator<a class="headerlink" href="#Simulator" title="Permalink to this heading"></a></h2>
<p>The simulator is roughly the same as the simulation for the black box model except it has an <code class="docutils literal notranslate"><span class="pre">environment</span></code> which samples stochastic variables and then changes parameters in the model. Note that in this case <code class="docutils literal notranslate"><span class="pre">run_stochastic</span></code> is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, since the variables are being sampled in AdaStress itself (rather than the model).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Base</span><span class="o">.</span><span class="nd">@kwdef</span><span class="w"> </span><span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">Simulator</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AdaStress</span><span class="o">.</span><span class="n">GrayBox</span>
<span class="w">    </span><span class="n">sim</span><span class="o">::</span><span class="kt">PyObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DynamicProblem</span><span class="p">(</span><span class="n">pump_model</span><span class="p">)</span>
<span class="w">    </span><span class="n">env</span><span class="o">::</span><span class="kt">AdaStress</span><span class="o">.</span><span class="n">Environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdaStress</span><span class="o">.</span><span class="n">Environment</span><span class="p">()</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">initialize</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="ss">:eff</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Normal</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">)</span><span class="w"> </span><span class="c">#creating</span>
<span class="w">    </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">=</span><span class="n">DynamicProblem</span><span class="p">(</span><span class="n">pump_model</span><span class="p">,</span><span class="w"> </span><span class="n">run_stochastic</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">update!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">::</span><span class="kt">AdaStress</span><span class="o">.</span><span class="n">EnvironmentValue</span><span class="p">)</span>
<span class="w">    </span><span class="c">#sim.mdl.set_values(&quot;MoveWater.eff&quot;, value[:eff])</span>
<span class="w">    </span><span class="n">disturbances</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;move_water.s.eff&quot;</span><span class="o">=&gt;</span><span class="n">value</span><span class="p">[</span><span class="ss">:eff</span><span class="p">])</span>
<span class="w">    </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">disturbances</span><span class="o">=</span><span class="n">disturbances</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
update! (generic function with 2 methods)
</pre></div></div>
</div>
<p>The isterminal and isevent functions will be the same as in the black box model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">isterminal!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span>
<span class="w">    </span><span class="n">has_faults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">fxns</span><span class="p">[</span><span class="s">&quot;move_water&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">any_faults</span><span class="p">()</span><span class="w"> </span><span class="c"># our external condition</span>
<span class="w">    </span><span class="n">terminal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">check_sim_end</span><span class="p">(</span><span class="n">external_condition</span><span class="o">=</span><span class="n">has_faults</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">terminal</span>
<span class="k">end</span>
<span class="k">function</span><span class="w"> </span><span class="n">isevent!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span>
<span class="w">    </span><span class="n">faults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">fxns</span><span class="p">[</span><span class="s">&quot;move_water&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">any_faults</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">faults</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
isevent! (generic function with 2 methods)
</pre></div></div>
</div>
<p>The interface to adastress is set up below. Of note is the observation interface, which observes <code class="docutils literal notranslate"><span class="pre">eff</span></code> (which is also the action in this simple setup)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Interface</span><span class="o">.</span><span class="n">reset!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initialize</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

<span class="n">Interface</span><span class="o">.</span><span class="n">environment</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">env</span>

<span class="n">Interface</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vcat</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">flows</span><span class="o">.</span><span class="n">wat_2</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">t</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">t_max</span><span class="p">)</span>

<span class="n">Interface</span><span class="o">.</span><span class="n">step!</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">::</span><span class="kt">AdaStress</span><span class="o">.</span><span class="n">EnvironmentValue</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update!</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span>

<span class="n">Interface</span><span class="o">.</span><span class="n">isterminal</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isterminal!</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

<span class="n">Interface</span><span class="o">.</span><span class="n">isevent</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isevent!</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

<span class="n">Interface</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulator</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">float</span><span class="p">(</span><span class="n">sum</span><span class="p">([(</span><span class="mi">16</span><span class="o">-</span><span class="n">max</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="s">&quot;flows.wat_1.s.pressure&quot;</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">mdp_env</span><span class="p">(;</span><span class="w"> </span><span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="n">mdp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Interface</span><span class="o">.</span><span class="n">ASTMDP</span><span class="p">(</span><span class="n">Simulator</span><span class="p">(;</span><span class="w"> </span><span class="n">kwargs</span><span class="o">...</span><span class="p">))</span>
<span class="w">    </span><span class="n">mdp</span><span class="o">.</span><span class="n">rewaan</span><span class="o">.</span><span class="n">event_bonus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2000.0</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mdp</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mdp_env (generic function with 1 method)
</pre></div></div>
</div>
<p>Now using the gray box mdp solver:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># AdaStress.enable(&quot;SoftActorCritic&quot;)</span>
<span class="c"># using AdaStress.SoftActorCritic</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Random.seed!(0)</span>
<span class="c"># sac = SAC(;</span>
<span class="c">#     obs_dim=2,</span>
<span class="c">#     act_dim=1,</span>
<span class="c">#     gamma=0.95,</span>
<span class="c">#     act_mins=-1*ones(1),    #number of standard deviations</span>
<span class="c">#     act_maxs=10*ones(1),</span>
<span class="c">#     hidden_sizes=[30,30,30],</span>
<span class="c">#     num_q=2,</span>
<span class="c">#     max_buffer_size=1000000,</span>
<span class="c">#     batch_size=128,</span>
<span class="c">#     epochs=100,</span>
<span class="c">#     update_after=0,</span>
<span class="c">#     update_every=1,</span>
<span class="c">#     steps_per_epoch=54,</span>
<span class="c">#     start_steps=100,</span>
<span class="c">#     max_ep_len=54,</span>
<span class="c">#     num_test_episodes=100,</span>
<span class="c">#     displays=[(:fails, mdp -&gt; mdp.sim.sim.mdl.fxns[&quot;MoveWater&quot;].has_fault(&quot;mech_break&quot;) )],</span>
<span class="c">#     use_gpu=false</span>
<span class="c"># )</span>

<span class="c"># SoftActorCritic.ProgressMeter.ijulia_behavior(:clear)</span>
<span class="c"># ac, info = sac(mdp_env)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># using PyPlot</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># plt.plot(info[&quot;fails&quot;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># plt.plot(info[&quot;score&quot;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># ac</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># i=0</span>
<span class="c"># mdlhists3 = Dict()</span>
<span class="c"># mdp = mdp_env()</span>
<span class="c"># for i in 1:100</span>
<span class="c">#     a= AdaStress.replay!(mdp, ac)</span>
<span class="c">#     mdlhists3[i] = mdp.sim.sim.hist</span>
<span class="c">#     i+=1</span>
<span class="c"># end</span>
<span class="c"># mdlhists3 = fmd.analyze.history.History(mdlhists3)</span>
<span class="c"># mdlhists3 = mdlhists3.flatten()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># a= AdaStress.replay!(mdp, ac)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># info</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># mdlhists3.plot_line(&quot;fxns.move_water.s.eff&quot;, &quot;fxns.move_water.s.total_flow&quot;,</span>
<span class="c">#                     &quot;flows.wat_2.s.flowrate&quot;, &quot;flows.wat_2.s.pressure&quot;, aggregation=&quot;percentile&quot;)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
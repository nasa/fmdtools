<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stochastic Modelling in fmdtools &mdash; fmdtools 2.0-rc-3 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/nbsphinx-code-cells.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/fmdtools_ico.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/logo_glow.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#about">About</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#flexible-modelling-paradigm">Flexible Modelling Paradigm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#powerful-simulation-techniques">Powerful Simulation Techniques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#efficient-analysis-process">Efficient Analysis Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#set-up-python-environment">Set up python environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#install-fmdtools">Install fmdtools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../README.html#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#explore-tutorials-and-resources">Explore Tutorials and Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#contributions">Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#citing-this-repository">Citing this repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../README.html#license-notices">License/Notices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../README.html#disclaimers">Disclaimers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/Development%20Guide.html">Development Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#why-fmdtools">Why fmdtools?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#introductory-tutorial">Introductory Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html">Intro to resilience modeling, simulation, and visualization in Python with fmdtools.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#author-daniel-hulse">Author: Daniel Hulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#version-2-0-rc-3">Version: 2.0-rc-3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#motivation-modeling-system-resilience">Motivation: Modeling System Resilience</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-is-resilience-important">Why is Resilience Important?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#enabling-proactive-design-process">Enabling proactive design process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-fmdtools-possible-competitors">Why fmdtools? Possible Competitors:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-fmdtools-pros">Why fmdtools? Pros:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#why-not-fmdtools-cons">Why <strong>not</strong> fmdtools? Cons:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#what-is-fmdtools-a-python-package-for-design-simulation-and-analysis-of-resilience">What is fmdtools? A Python package for <strong>design</strong>, <strong>simulation</strong>, and <strong>analysis</strong> of resilience.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#what-is-fmdtools-repo-structure">What is fmdtools? Repo Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#activity-download-and-install-fmdtools">Activity: Download and Install fmdtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#analysis-workflow-structure">Analysis Workflow/Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#defining-a-model">Defining a Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#id1">Defining a Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#function-code-template">Function Code Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#model-code-template">Model Code Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#demo-model-activity-examples-pump-ex-pump-py">Demo Model Activity: examples/pump/ex_pump.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#more-resources-for-model-definition">More Resources for Model Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#notebook-activity">Notebook Activity:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-static-undirected-propagation">Simulation Concepts: Static/Undirected Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-propagation-over-time">Simulation Concepts: Propagation over Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-types-of-simulations">Simulation Concepts: Types of Simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-sampling-approaches">Simulation Concepts: Sampling Approaches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#simulation-concepts-things-to-consider">Simulation Concepts: Things to Consider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#activity-simulate-the-model">Activity: Simulate the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#analysis-modules">Analysis Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#analysis-activity">Analysis Activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#conclusions-summary">Conclusions/Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Intro_to_fmdtools.html#further-reading-links">Further Reading/Links</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#model-development-best-practices">Model Development Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#pay-attention-to-and-document-the-fmdtools-version">Pay attention to and document the fmdtools version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#plan-your-model-to-avoid-technical-debt">Plan your model to avoid technical debt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#don-t-copy-inherit-and-functionalize">Don’t copy, inherit and functionalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#document-your-code-sometimes-before-your-write-it">Document your code, sometimes <em>before</em> your write it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#don-t-get-ahead-of-yourself-try-to-get-a-running-simulation-first">Don’t get ahead of yourself–try to get a running simulation first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#preserve-your-prototype-setup-by-formalizing-it-as-a-test">Preserve your prototype setup by formalizing it as a test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#edit-your-code">Edit your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#structuring-a-model">Structuring a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#use-model-constructs-to-simplify-your-code">Use model constructs to simplify your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#style-advice">Style advice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/Development%20Guide.html#how-to-contribute">How to Contribute</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#repo-structure">Repo Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Development%20Guide.html#remote-structure">Remote Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#development-process">Development Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Development%20Guide.html#release-checklist">Release Checklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/Development%20Guide.html#upload-to-pypi">Upload to PyPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#roles">Roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#style-formatting">Style/Formatting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/Development%20Guide.html#testing">Testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/Examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#pump">Pump</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/pump/readme.html">Pump Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/pump/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#multirotor">Multirotor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/multirotor/readme.html">Drone Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multirotor/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#tank">Tank</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/tank/readme.html">Tank Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/tank/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#eps">EPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/eps/readme.html">EPS Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/eps/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#action-sequence-graph">Action Sequence Graph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/asg_demo/readme.html">ASG Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/asg_demo/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/asg_demo/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/asg_demo/readme.html#notebooks">Notebooks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#rover">Rover</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/rover/readme.html">Rover Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/rover/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#multiflow-demo">Multiflow Demo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html">MultiFlow Demo Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/multiflow_demo/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples/Examples.html#taxiway">Taxiway</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples/taxiway/readme.html">Taxiway Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#scripts-and-tests">Scripts and tests:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#notebooks">Notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../examples/taxiway/readme.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/fmdtools.html">Module Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/fmdtools.define.html">fmdtools.define</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html">fmdtools.define.architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-base">fmdtools.define.architecture.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-action">fmdtools.define.architecture.action</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-component">fmdtools.define.architecture.component</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-function">fmdtools.define.architecture.function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.architecture.html#fmdtools-define-architecture-geom">fmdtools.define.architecture.geom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html">fmdtools.define.block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.base">fmdtools.define.block.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.action">fmdtools.define.block.action</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.component">fmdtools.define.block.component</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.block.html#module-fmdtools.define.block.function">fmdtools.define.block.function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html">fmdtools.define.container</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#fmdtools-define-container-base">fmdtools.define.container.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#module-fmdtools.define.container.mode">fmdtools.define.container.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#fmdtools-define-container-state">fmdtools.define.container.state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#fmdtools-define-container-parameter">fmdtools.define.container.parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#module-fmdtools.define.container.rand">fmdtools.define.container.rand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.container.html#module-fmdtools.define.container.time">fmdtools.define.container.time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html">fmdtools.define.flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html#fmdtools-define-flow-base">fmdtools.define.flow.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html#module-fmdtools.define.flow.multiflow">fmdtools.define.flow.multiflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.flow.html#module-fmdtools.define.flow.commsflow">fmdtools.define.flow.commsflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html">fmdtools.define.object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.base">fmdtools.define.object.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.timer">fmdtools.define.object.timer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.geom">fmdtools.define.object.geom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../docs/fmdtools.define.object.html#module-fmdtools.define.object.coords">fmdtools.define.object.coords</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.html#fmdtools-define-base">fmdtools.define.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.define.html#module-fmdtools.define.environment">fmdtools.define.environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/fmdtools.sim.html">fmdtools.sim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#fmdtools-sim-propagate">fmdtools.sim.propagate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#module-fmdtools.sim.scenario">fmdtools.sim.scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#module-fmdtools.sim.sample">fmdtools.sim.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.sim.html#module-fmdtools.sim.search">fmdtools.sim.search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html">fmdtools.analyze</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.common">fmdtools.analyze.common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.result">fmdtools.analyze.result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.history">fmdtools.analyze.history</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.graph">fmdtools.analyze.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.tabulate">fmdtools.analyze.tabulate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../docs/fmdtools.analyze.html#module-fmdtools.analyze.phases">fmdtools.analyze.phases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CONTRIBUTORS.html">Contributors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#internal-contributors">Internal Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#external-contributors">External Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#alumni-and-interns">Alumni and Interns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../CONTRIBUTORS.html#fmdtools-at-osu">fmdtools at OSU</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">fmdtools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Stochastic Modelling in fmdtools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/._build/html/examples/pump/Stochastic_Modelling.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Stochastic-Modelling-in-fmdtools">
<h1>Stochastic Modelling in fmdtools<a class="headerlink" href="#Stochastic-Modelling-in-fmdtools" title="Permalink to this heading"></a></h1>
<p>This notebook covers the basics of stochastic modelling in fmdtools. Stochastic models are models which run <em>non-determinsitically</em>, meaning that simulating the model at the same inputs results in different outputs because of randomness or uncertainty in the model behavior. Thus, to determine the <em>distribution of outcomes</em> which may result from a simulation, a stochastic model must be run a number of times. This notebook will cover: - How to construct a stochastic model by adding <em>stochastic
states</em> to function blocks and incorporating them in function behavior - How to simulate single scenarios and distributions of scenarios in <code class="docutils literal notranslate"><span class="pre">propagate</span></code> methods - How to visualize and analyze the results of stochastic model simulations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fmdtools.sim.sample</span> <span class="kn">import</span> <span class="n">ParameterSample</span><span class="p">,</span> <span class="n">ParameterDomain</span>
<span class="kn">import</span> <span class="nn">fmdtools.sim.propagate</span> <span class="k">as</span> <span class="nn">propagate</span>
<span class="kn">from</span> <span class="nn">fmdtools.analyze.graph</span> <span class="kn">import</span> <span class="n">FunctionArchitectureGraph</span>

<span class="kn">import</span> <span class="nn">inspect</span> <span class="c1"># we will be using inspect to look at</span>
</pre></div>
</div>
</div>
<p>This notebook uses Pump model in <code class="docutils literal notranslate"><span class="pre">pump_stochastic.py</span></code>, which is an adaptation of the original <code class="docutils literal notranslate"><span class="pre">ex_pump.py</span></code> model with stochastic states added.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pump_stochastic</span> <span class="kn">import</span> <span class="n">Pump</span>
</pre></div>
</div>
</div>
<p>Below is the structure, with the same functions/flows as before.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">FunctionArchitectureGraph</span><span class="p">(</span><span class="n">Pump</span><span class="p">())</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_5_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_5_0.png" />
</div>
</div>
<section id="Model-Setup">
<h2>Model Setup<a class="headerlink" href="#Model-Setup" title="Permalink to this heading"></a></h2>
<p>This model has been augmented stochastic states and behaviors to enable stochastic simulation using the <code class="docutils literal notranslate"><span class="pre">Rand</span></code> class.</p>
<ul class="simple">
<li><p>See rand documentation: <a class="reference external" href="https://nasa.github.io/fmdtools/docs/fmdtools.define.html#fmdtools.define.container.rand.Rand">https://nasa.github.io/fmdtools/docs/fmdtools.define.html#fmdtools.define.container.rand.Rand</a></p></li>
</ul>
<p>This is what a Rand object looks like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fmdtools.define.container.rand</span> <span class="kn">import</span> <span class="n">Rand</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">Rand</span><span class="p">()</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Rand(rng=Generator(PCG64) at 0x22121CCE880, probs=[], probdens=1.0, seed=42, run_stochastic=False)
</pre></div></div>
</div>
<p>Below, <code class="docutils literal notranslate"><span class="pre">ImportEERand</span></code> container is used in the ImportEE function to add two random states (via <code class="docutils literal notranslate"><span class="pre">ImportEERandState</span></code>): - <code class="docutils literal notranslate"><span class="pre">effstate</span></code>, the quality of the input voltage (i.e. large fluctuations from a step change in power) - <code class="docutils literal notranslate"><span class="pre">grid_noise</span></code>, which is meant to be fluctuations in voltage from the power source (i.e., more ordinary noise)</p>
<p>This is then reflected in the behavior, which is defined in the <code class="docutils literal notranslate"><span class="pre">Rand.set_rand_state</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">Rand</span><span class="o">.</span><span class="n">set_rand_state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function set_rand_state in module fmdtools.define.container.rand:

set_rand_state(self, statename, methodname, *args)
    Update the given random state with a given method and arguments.

    (if in run_stochastic mode)

    Parameters
    ----------
    statename : str
        name of the random state defined
    methodname :
        str name of the numpy method to call in the rng
    *args : args
        arguments for the numpy method

</pre></div></div>
</div>
<p>In this method,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">statename</span></code> is the name of the random state, while</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">methodname</span></code> corresponds to the name of a random distribution to update the state from. These distributions are pulled from a numpy random number generator (see <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#distributions">numpy documentation</a>) and include most one might need including normal, beta, uniform, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code> refers to the corresponding arguments to call the given method with, which should be pulled from the corresponding documentation. Below, we have points where this is called.</p></li>
</ul>
<p>Belo we show how this is used in the model:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pump_stochastic</span> <span class="kn">import</span> <span class="n">ImportEERand</span><span class="p">,</span> <span class="n">ImportEERandState</span><span class="p">,</span> <span class="n">ImportEE</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">ImportEERand</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">ImportEERandState</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
class ImportEERand(Rand, copy_default=True):
    s: ImportEERandState = ImportEERandState()

class ImportEERandState(State):
    effstate: float = 1.0
    grid_noise: float = 1.0

</pre></div></div>
</div>
<p>In this setup, the <code class="docutils literal notranslate"><span class="pre">effstate</span></code> and <code class="docutils literal notranslate"><span class="pre">grid_noise</span></code> states are to be set by the rng in <code class="docutils literal notranslate"><span class="pre">ImportEERand</span></code>. Below shows how this is embodied in behavior:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">ImportEE</span><span class="o">.</span><span class="n">behavior</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    def behavior(self, time):
        if self.m.has_fault(&#39;no_v&#39;):
            self.r.s.effstate = 0.0  # an open circuit means no voltage is exported
        elif self.m.has_fault(&#39;inf_v&#39;):
            self.r.s.effstate = 100.0  # a voltage spike means voltage is much higher
        else:
            if time &gt; self.t.time:
                self.r.set_rand_state(&#39;effstate&#39;, &#39;triangular&#39;, 0.9, 1, 1.1)
        if time &gt; self.t.time:
            self.r.set_rand_state(&#39;grid_noise&#39;, &#39;normal&#39;,
                                  1, 0.05*(2+np.sin(np.pi/2*time)))
        self.ee_out.s.voltage = self.r.s.grid_noise*self.r.s.effstate * 500

</pre></div></div>
</div>
<p>As shown, <code class="docutils literal notranslate"><span class="pre">set_rand_state</span></code> is used:</p>
<ul class="simple">
<li><p>First, to pull <code class="docutils literal notranslate"><span class="pre">effstate</span></code> from a triangular distribution with minimum 0.9, mode 1.0, and max 1.1</p></li>
<li><p>Parameters are provided here: <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.triangular.html#numpy.random.Generator.triangular">https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.triangular.html#numpy.random.Generator.triangular</a></p></li>
<li><p>Second, to pull <code class="docutils literal notranslate"><span class="pre">grid_noise</span></code> from a normal distribution centered on 1 with a standard deviation that varies over time according to a sine wave.</p></li>
<li><p>Parameters are provided here: <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html#numpy.random.Generator.normal">https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html#numpy.random.Generator.normal</a></p></li>
</ul>
<section id="Move-Water-Example">
<h3>Move Water Example<a class="headerlink" href="#Move-Water-Example" title="Permalink to this heading"></a></h3>
<p>The Move Water function has a similar setup, except the stochasticity is auto-updated at each timestep. This is done by providing an <code class="docutils literal notranslate"><span class="pre">eff_update</span></code> class varaible to the <code class="docutils literal notranslate"><span class="pre">RandState</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pump_stochastic</span> <span class="kn">import</span> <span class="n">MoveWat</span><span class="p">,</span> <span class="n">MoveWatRandState</span><span class="p">,</span> <span class="n">MoveWatRand</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">MoveWatRandState</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
class MoveWatRandState(State):
    eff: float = 1.0
    eff_update = (&#39;normal&#39;, (1.0, 0.2))

</pre></div></div>
</div>
<p>In this case, the normal distribution will be drawn from with mean 1.0 and standard deviation 0.2.</p>
<p>The advantage of this is that simple stochastic behaviors do not need to be defined in the behavior method, however, it is less flexible than the previous approach, since one is limited to always drawing from the same distribution at each time-step. The corresponding behavior method (below) thus has no <code class="docutils literal notranslate"><span class="pre">set_rand_state</span></code> call, since the state <code class="docutils literal notranslate"><span class="pre">eff</span></code> is automaticall updated outside the behavior definition.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">MoveWat</span><span class="o">.</span><span class="n">behavior</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    def behavior(self, time):
        self.s.eff = self.r.s.eff
        super().behavior(time)
        if time &gt; self.t.time:
            self.s.inc(total_flow=self.wat_out.s.flowrate)

</pre></div></div>
</div>
</section>
<section id="Model-Considerations">
<h3>Model Considerations<a class="headerlink" href="#Model-Considerations" title="Permalink to this heading"></a></h3>
<p>To get a distribution of stochastic behavior, the simulation must be run over a number of different random seeds. This <code class="docutils literal notranslate"><span class="pre">seed</span></code> parameter ensures that each simulation in the same random thread will produce the same results, and that results can be replicated from stochastic simulation by running the model with the same seed.</p>
<p>By default, the seed for the <code class="docutils literal notranslate"><span class="pre">Rand</span></code> in each of the functions is set to match the Model <code class="docutils literal notranslate"><span class="pre">Rand</span></code>, meaning that passing a sead at the <code class="docutils literal notranslate"><span class="pre">Model</span></code> level sets it in all the containing functions also. This can be set by passing an <code class="docutils literal notranslate"><span class="pre">r</span></code> parameter to the Model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl1</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">23</span><span class="p">})</span>
<span class="n">mdl1</span><span class="o">.</span><span class="n">fxns</span><span class="p">[</span><span class="s1">&#39;move_water&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MoveWatRand(rng=Generator(PCG64) at 0x22121C95620, probs=[], probdens=1.0, seed=23, run_stochastic=False, s=MoveWatRandState(eff=1.0))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl2</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">mdl2</span><span class="o">.</span><span class="n">fxns</span><span class="p">[</span><span class="s1">&#39;move_water&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MoveWatRand(rng=Generator(PCG64) at 0x22121C95A80, probs=[], probdens=1.0, seed=10, run_stochastic=False, s=MoveWatRandState(eff=1.0))
</pre></div></div>
</div>
</section>
</section>
<section id="Simulation-and-Analysis">
<h2>Simulation and Analysis<a class="headerlink" href="#Simulation-and-Analysis" title="Permalink to this heading"></a></h2>
<p>With this model set up, we can now simulate it using the methods in <code class="docutils literal notranslate"><span class="pre">propagate</span></code>.</p>
<p>First, let’s simulate it in the nominal scenario:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_28_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_28_0.png" />
</div>
</div>
<p>As shown, even with all of these random states, it doesn’t appear that the behavior actually changes stochastically over time. This is because, by default, the model is set to run <em>deterministically</em>, meaning the stochastic states take their default values. To run stochastically, we use the option <code class="docutils literal notranslate"><span class="pre">run_stochastic=True</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_31_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_31_0.png" />
</div>
</div>
<p>As shown, this is more what we would expect from a random . Note that this simulation comes from the default model seed, and will this will always be the same. To get a different seed, we can pass new modelparams as an argument to <code class="docutils literal notranslate"><span class="pre">propagate.nominal</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">mdl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">110</span><span class="p">}))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_33_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_33_0.png" />
</div>
</div>
<p>We can further simulate faults as we would before.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">one_fault</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="s1">&#39;export_water&#39;</span><span class="p">,</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                       <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mdl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">110</span><span class="p">}))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;fxns.move_water.s.total_flow&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;flows.wat_2.s.flowrate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;flows.wat_2.s.pressure&#39;</span><span class="p">,</span>
                        <span class="n">time_slice</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_35_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_35_0.png" />
</div>
</div>
<p>As shown, the stochastic states still simulated over time after the fault.</p>
<p>One thing to watch in stochastic models is that <strong>off-nominal behavior may be more difficult to track</strong>, since stochastic behavior may vary without necessarily being adverse behavior. This can be a problem because many of the visualizations (e.g., in <code class="docutils literal notranslate"><span class="pre">graph</span></code>) are based on finding <em>differences</em> between faulty and nominal models to visualize degradation, these methods may be less useful/reliable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;fxns.import_signal.r.s.sig_noise&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_37_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_37_0.png" />
</div>
</div>
<p>In the blockage scenario, there is no effect on the underlying stochastic states, since nothing was set up for this in the behavior. In the <code class="docutils literal notranslate"><span class="pre">no_sig</span></code> fault, on the other hand, we defined the signal noise to go to zero, as shown:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">one_fault</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="s1">&#39;import_signal&#39;</span><span class="p">,</span> <span class="s1">&#39;no_sig&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                        <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mdl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">110</span><span class="p">}))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;fxns.import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span>
                         <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">time_slice</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_39_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_39_0.png" />
</div>
</div>
<p>Because stochastic models are non-deterministic, we are often interested not in the results of a single thread, but of the distribution of outcomes that might occur. To perform this kind of assessment, we can use a <code class="docutils literal notranslate"><span class="pre">ParameterSample</span></code> to instantiate the model with a number of different seeds.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ParameterSample</span><span class="o">.</span><span class="n">add_variable_replicates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function add_variable_replicates in module fmdtools.sim.sample:

add_variable_replicates(self, x_combos, replicates=1, seed_comb=&#39;shared&#39;, name=&#39;var&#39;, weight=1.0)
    Add replicates for the given cominations of variables.

    Parameters
    ----------
    x_combos : list
        List of combinations of variable values. [x_1, x_2...]. If empty, the
        default values of x are used.
    replicates : int, optional
        Number of replicates to add of the variable. The default is 1.
    seed_comb : str, optional
        How to combine seeds (&#39;shared&#39; or &#39;independent&#39;). &#39;shared&#39; uses the same
        seed for each value while &#39;independent&#39; uses different seeds over all
        variable values. The default is &#39;shared&#39;.
    name : str, optional
        Name prefix for the set of replicates. The default is &#39;var&#39;.
    weight : float, optional
        Total weight for the replicates (i.e., total probability to divide between
        samples). The default is 1.0.

    Examples
    --------
    &gt;&gt;&gt; ex_ps = ParameterSample(expd)
    &gt;&gt;&gt; ex_ps.add_variable_replicates([[1,1], [2,2]])
    &gt;&gt;&gt; ex_ps
    ParameterSample of scenarios:
     - rep0_var_0
     - rep0_var_1
    &gt;&gt;&gt; scen0 =ex_ps.scenarios()[0]
    &gt;&gt;&gt; scen0.prob
    0.5
    &gt;&gt;&gt; scen0.p[&#39;x&#39;]
    1
    &gt;&gt;&gt; scen0.p[&#39;y&#39;]
    1
    &gt;&gt;&gt; scen0.inputparams
    {0: 1, 1: 1}
    &gt;&gt;&gt; scen1 =ex_ps.scenarios()[1]
    &gt;&gt;&gt; scen1.prob
    0.5
    &gt;&gt;&gt; scen1.p[&#39;x&#39;]
    2
    &gt;&gt;&gt; scen1.p[&#39;y&#39;]
    2
    &gt;&gt;&gt; scen1.inputparams
    {0: 2, 1: 2}

</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">replicates</span></code> option can also be used in ParameterSample methods to simultaneously change the input parameters and seeds of the model. Below, we create an sample to simulate the model 100 times.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">ParameterSample</span><span class="p">()</span>
<span class="n">ps</span><span class="o">.</span><span class="n">add_variable_replicates</span><span class="p">([],</span> <span class="n">replicates</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses</span><span class="p">,</span> <span class="n">mdlhists</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">parameter_sample</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|██████████| 100/100 [00:04&lt;00:00, 21.05it/s]
</pre></div></div>
</div>
<p>To evaluate this behavior over time, we can then use <code class="docutils literal notranslate"><span class="pre">History.plot_line</span></code>, to plot the <em>distribution</em> of behaviors over time. <code class="docutils literal notranslate"><span class="pre">History.plot_line</span></code> has a number of different options for visualization of distributions. For example, below we plot model states as individual lines:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mdlhists</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.move_water.s.total_flow&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.wat_2.s.pressure&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.sig_1.s.power&#39;</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">comp_groups</span><span class="o">=</span><span class="p">{},</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_46_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_46_0.png" />
</div>
</div>
<p>Or as percentiles:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">mdlhist</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.move_water.s.total_flow&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.wat_2.s.pressure&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.sig_1.s.power&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">comp_groups</span><span class="o">=</span><span class="p">{},</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_48_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_48_0.png" />
</div>
</div>
<p>Or as a mean with confidence interval:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mdlhists</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.move_water.s.total_flow&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.wat_2.s.pressure&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.sig_1.s.power&#39;</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">comp_groups</span><span class="o">=</span><span class="p">{},</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;mean_ci&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_50_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_50_0.png" />
</div>
</div>
<p>We can also compare stochastic output over a set of scenarios using <code class="docutils literal notranslate"><span class="pre">plot.hist</span></code> with the <code class="docutils literal notranslate"><span class="pre">comp_groups</span></code> parameter, which places the scenarios in different groups.</p>
<p>This can be done by first creating an ParameterDomain with the variable we wish to compare. The pump still has one real parameter–the fault delay.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pump_stochastic</span> <span class="kn">import</span> <span class="n">PumpParam</span>
<span class="n">pd</span> <span class="o">=</span> <span class="n">ParameterDomain</span><span class="p">(</span><span class="n">PumpParam</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;delay&quot;</span><span class="p">)</span>
<span class="n">pd</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ParameterDomain with:
 - variables: {&#39;delay&#39;: (0, 100)}
 - constants: {}
 - parameter_initializer: PumpParam
</pre></div></div>
</div>
<p>This can then be sampled with a ParameterSample:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">ParameterSample</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
<span class="n">ps</span><span class="o">.</span><span class="n">add_variable_replicates</span><span class="p">([[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">replicates</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;delay1&quot;</span><span class="p">)</span>
<span class="n">ps</span><span class="o">.</span><span class="n">add_variable_replicates</span><span class="p">([[</span><span class="mi">10</span><span class="p">]],</span> <span class="n">replicates</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;delay10&quot;</span><span class="p">)</span>
<span class="n">ps</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ParameterSample of scenarios:
 - rep0_delay1_0
 - rep1_delay1_1
 - rep2_delay1_2
 - rep3_delay1_3
 - rep4_delay1_4
 - rep5_delay1_5
 - rep6_delay1_6
 - rep7_delay1_7
 - rep8_delay1_8
 - rep9_delay1_9
 - ... (200 total)
</pre></div></div>
</div>
<p>Since this delay only shows up in blockage fault modes, to compare the behaviors, we will first simulate it in a nested approach with only the blockage fault added.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faultdomains</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fd&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;fault&quot;</span><span class="p">,</span> <span class="s2">&quot;export_water&quot;</span><span class="p">,</span> <span class="s2">&quot;block&quot;</span><span class="p">),</span> <span class="p">{})}</span>
<span class="n">faultsamples</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;fault_phases&quot;</span><span class="p">,</span> <span class="s2">&quot;fd&quot;</span><span class="p">),</span> <span class="p">{})}</span>
<span class="n">endclasses</span><span class="p">,</span> <span class="n">mdlhists</span><span class="p">,</span> <span class="n">apps</span><span class="o">=</span><span class="n">propagate</span><span class="o">.</span><span class="n">nested_sample</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">faultdomains</span><span class="o">=</span><span class="n">faultdomains</span><span class="p">,</span> <span class="n">faultsamples</span><span class="o">=</span><span class="n">faultsamples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   0%|          | 1/200 [00:00&lt;00:44,  4.45it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   2%|▏         | 4/200 [00:00&lt;00:44,  4.38it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   3%|▎         | 6/200 [00:01&lt;00:43,  4.43it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   4%|▍         | 9/200 [00:02&lt;00:43,  4.35it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   6%|▌         | 11/200 [00:02&lt;00:43,  4.34it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   6%|▋         | 13/200 [00:02&lt;00:42,  4.43it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   8%|▊         | 15/200 [00:03&lt;00:40,  4.53it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:   8%|▊         | 17/200 [00:03&lt;00:40,  4.54it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  10%|▉         | 19/200 [00:04&lt;00:40,  4.46it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  10%|█         | 21/200 [00:04&lt;00:41,  4.36it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  12%|█▏        | 23/200 [00:05&lt;00:40,  4.37it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  12%|█▎        | 25/200 [00:05&lt;00:40,  4.35it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  14%|█▎        | 27/200 [00:06&lt;00:40,  4.32it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  14%|█▍        | 29/200 [00:06&lt;00:38,  4.48it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  16%|█▌        | 31/200 [00:07&lt;00:38,  4.42it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  16%|█▋        | 33/200 [00:07&lt;00:37,  4.45it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  18%|█▊        | 35/200 [00:07&lt;00:37,  4.37it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  18%|█▊        | 37/200 [00:08&lt;00:36,  4.48it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  20%|█▉        | 39/200 [00:08&lt;00:36,  4.37it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  20%|██        | 41/200 [00:09&lt;00:35,  4.52it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  22%|██▏       | 44/200 [00:09&lt;00:33,  4.62it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  23%|██▎       | 46/200 [00:10&lt;00:33,  4.57it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  24%|██▍       | 48/200 [00:10&lt;00:33,  4.59it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  26%|██▌       | 52/200 [00:11&lt;00:33,  4.43it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  28%|██▊       | 55/200 [00:12&lt;00:33,  4.37it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  28%|██▊       | 56/200 [00:12&lt;00:33,  4.32it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  29%|██▉       | 58/200 [00:13&lt;00:31,  4.47it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  30%|███       | 61/200 [00:13&lt;00:30,  4.58it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  32%|███▏      | 64/200 [00:14&lt;00:29,  4.62it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  33%|███▎      | 66/200 [00:14&lt;00:29,  4.51it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  34%|███▍      | 68/200 [00:15&lt;00:29,  4.54it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  35%|███▌      | 70/200 [00:15&lt;00:28,  4.49it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  36%|███▌      | 72/200 [00:16&lt;00:28,  4.56it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  37%|███▋      | 74/200 [00:16&lt;00:27,  4.55it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  40%|████      | 80/200 [00:17&lt;00:27,  4.44it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  42%|████▏     | 84/200 [00:18&lt;00:26,  4.35it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  43%|████▎     | 86/200 [00:19&lt;00:26,  4.36it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  44%|████▍     | 88/200 [00:19&lt;00:25,  4.40it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  46%|████▌     | 91/200 [00:20&lt;00:24,  4.37it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  46%|████▋     | 93/200 [00:20&lt;00:23,  4.50it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  48%|████▊     | 96/200 [00:21&lt;00:22,  4.57it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  49%|████▉     | 98/200 [00:22&lt;00:22,  4.51it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  50%|████▉     | 99/200 [00:22&lt;00:22,  4.49it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  53%|█████▎    | 106/200 [00:23&lt;00:20,  4.50it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  67%|██████▋   | 134/200 [00:30&lt;00:14,  4.41it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  84%|████████▎ | 167/200 [00:37&lt;00:07,  4.37it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE: 100%|██████████| 200/200 [00:45&lt;00:00,  4.38it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>Next, we get just the scenarios of interest:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_mdlhists</span> <span class="o">=</span> <span class="n">mdlhists</span><span class="o">.</span><span class="n">get_scens</span><span class="p">(</span><span class="s1">&#39;export_water_block_t27p0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, we create some comparison groups to group the results by:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_groups</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;delay_1&#39;</span><span class="p">:</span> <span class="n">ps</span><span class="o">.</span><span class="n">get_scens</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;delay&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="s1">&#39;delay_10&#39;</span><span class="p">:</span> <span class="n">ps</span><span class="o">.</span><span class="n">get_scens</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;delay&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})}</span>
</pre></div>
</div>
</div>
<p>These are the resulting behaviors:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figax</span> <span class="o">=</span> <span class="n">comp_mdlhists</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="s1">&#39;fxns.move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.move_water.s.total_flow&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.wat_2.s.pressure&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;fxns.import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;fxns.import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;flows.ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;flows.sig_1.s.power&#39;</span><span class="p">,</span>
                                <span class="n">comp_groups</span><span class="o">=</span><span class="n">comp_groups</span><span class="p">,</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span> <span class="n">time_slice</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_65_0.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_65_0.png" />
</div>
</div>
<p>There a few interesting aspects of this simulation: - First, some of the <code class="docutils literal notranslate"><span class="pre">delay_1</span></code> design simulations have a zero flowrate before the fault is injected. This is because the reduced delay means that nominal behavior can easily cause the fault–all that nees to happen is for the pressure to go over 15 for two time-steps, which is entirely forseeable with all the variability in the simulation. This can also be seen in the “total_flow” graph. - Second, the <code class="docutils literal notranslate"><span class="pre">delay_10</span></code> gives the nominal behavior
until the fault time, when pressure increases dramatically. This is also observed in the <code class="docutils literal notranslate"><span class="pre">delay_1</span></code> design, but with a much smaller delay (1 instead of 1).</p>
<p>Finally, running multiple simulations relies on the NominalApproach, it can be combined fairly easily with existing methods used in conjunction with NominalApproach. (e.g., <code class="docutils literal notranslate"><span class="pre">tabulate.NestedComparison</span></code>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">fmdtools.analyze.tabulate</span> <span class="kn">import</span> <span class="n">NestedComparison</span>
<span class="n">comp</span> <span class="o">=</span> <span class="n">NestedComparison</span><span class="p">(</span><span class="n">endclasses</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;p.delay&quot;</span><span class="p">],</span> <span class="n">apps</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;fault&quot;</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">],</span> <span class="n">ci_metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">],</span> <span class="n">default_stat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp</span><span class="o">.</span><span class="n">as_table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>cost</th>
      <th>cost_lb</th>
      <th>cost_ub</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <th>block</th>
      <td>15198.134116</td>
      <td>14514.478099</td>
      <td>15881.346779</td>
    </tr>
    <tr>
      <th>1</th>
      <th>block</th>
      <td>13590.756110</td>
      <td>13119.199763</td>
      <td>14104.400379</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp</span><span class="o">.</span><span class="n">as_plot</span><span class="p">(</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="n">color_factor</span><span class="o">=</span><span class="s2">&quot;fault&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 600x400 with 1 Axes&gt;, &lt;Axes: xlabel=&#39;p.delay&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_70_1.png" src="../../../../_images/._build_html_examples_pump_Stochastic_Modelling_70_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
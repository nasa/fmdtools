<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stochastic Modelling in fmdtools &mdash; fmdtools 2.0-alpha documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/fmdtools_ico.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo_glow.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">README</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../README.html#contributions">Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../README.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../README.html#notices">Notices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../README.html#disclaimers">Disclaimers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/Development%20Guide.html">Development Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../docs/Development%20Guide.html#how-to-write-good-models-development-best-practices">How to Write Good Models - Development Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#plan-your-model-to-avoid-technical-debt">Plan your model to avoid technical debt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#don-t-copy-inherit-and-functionalize">Don’t copy, inherit and functionalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#document-your-code-sometimes-before-your-write-it">Document your code, sometimes <em>before</em> your write it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#don-t-get-ahead-of-yourself-try-to-get-a-running-simulation-first">Don’t get ahead of yourself–try to get a running simulation first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#preserve-your-prototype-setup-by-formalizing-it-as-a-test">Preserve your prototype setup by formalizing it as a test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#edit-your-code">Edit your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#structuring-a-model">Structuring a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#use-model-constructs-to-simplify-your-code">Use model constructs to simplify your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#style-advice">Style advice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/Development%20Guide.html#see-also">See also</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/Examples.html">Examples</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/fmdtools.html">Module Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../docs/fmdtools.define.html">fmdtools.define package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.block">fmdtools.define.block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.common">fmdtools.define.common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.flow">fmdtools.define.flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.mode">fmdtools.define.mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.model">fmdtools.define.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.parameter">fmdtools.define.parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.rand">fmdtools.define.rand</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.state">fmdtools.define.state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.define.html#module-fmdtools.define.time">fmdtools.define.time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../docs/fmdtools.sim.html">fmdtools.sim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.sim.html#fmdtools-sim-propagate">fmdtools.sim.propagate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.sim.html#module-fmdtools.sim.scenario">fmdtools.sim.scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.sim.html#module-fmdtools.sim.approach">fmdtools.sim.approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.sim.html#module-fmdtools.sim.search">fmdtools.sim.search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../docs/fmdtools.analyze.html">fmdtools.analyze package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.analyze.html#module-fmdtools.analyze.graph">fmdtools.analyze.result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.analyze.html#module-fmdtools.analyze.plot">fmdtools.analyze.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.analyze.html#module-0">fmdtools.analyze.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docs/fmdtools.analyze.html#module-fmdtools.analyze.tabulate">fmdtools.analyze.tabulate</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">fmdtools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Stochastic Modelling in fmdtools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/pump/Stochastic_Modelling.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Stochastic-Modelling-in-fmdtools">
<h1>Stochastic Modelling in fmdtools<a class="headerlink" href="#Stochastic-Modelling-in-fmdtools" title="Permalink to this headline"></a></h1>
<p>This notebook covers the basics of stochastic modelling in fmdtools. Stochastic models are models which run <em>non-determinsitically</em>, meaning that simulating the model at the same inputs results in different outputs because of randomness or uncertainty in the model behavior. Thus, to determine the <em>distribution of outcomes</em> which may result from a simulation, a stochastic model must be run a number of times. This notebook will cover: - How to construct a stochastic model by adding <em>stochastic
states</em> to function blocks and incorporating them in function behavior - How to simulate single scenarios and distributions of scenarios in <code class="docutils literal notranslate"><span class="pre">propagate</span></code> methods - How to visualize and analyze the results of stochastic model simulations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fmdtools.define.rand</span> <span class="kn">import</span> <span class="n">Rand</span>
<span class="kn">from</span> <span class="nn">fmdtools.sim.approach</span> <span class="kn">import</span> <span class="n">SampleApproach</span><span class="p">,</span> <span class="n">NominalApproach</span>
<span class="kn">from</span> <span class="nn">fmdtools.define.block</span> <span class="kn">import</span> <span class="n">FxnBlock</span><span class="p">,</span> <span class="n">Block</span>
<span class="kn">import</span> <span class="nn">fmdtools.sim.propagate</span> <span class="k">as</span> <span class="nn">propagate</span>
<span class="kn">import</span> <span class="nn">fmdtools.analyze</span> <span class="k">as</span> <span class="nn">an</span>
<span class="kn">from</span> <span class="nn">fmdtools.analyze.graph</span> <span class="kn">import</span> <span class="n">ModelGraph</span>

<span class="kn">import</span> <span class="nn">inspect</span> <span class="c1"># we will be using inspect to look at</span>
</pre></div>
</div>
</div>
<p>This notebook uses Pump model in <code class="docutils literal notranslate"><span class="pre">pump_stochastic.py</span></code>, which is an adaptation of the original <code class="docutils literal notranslate"><span class="pre">ex_pump.py</span></code> model with stochastic states added.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pump_stochastic</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<p>Below is the structure, with the same functions/flows as before.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">ModelGraph</span><span class="p">(</span><span class="n">Pump</span><span class="p">())</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_5_0.png" src="../../_images/examples_pump_Stochastic_Modelling_5_0.png" />
</div>
</div>
<section id="Model-Setup">
<h2>Model Setup<a class="headerlink" href="#Model-Setup" title="Permalink to this headline"></a></h2>
<p>This model has been augmented stochastic states and behaviors to enable stochastic simulation using the <code class="docutils literal notranslate"><span class="pre">Rand</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">Rand</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on class Rand in module fmdtools.define.rand:

class Rand(recordclass.datatype.dataobject)
 |  Rand(*args, seed=42, run_stochastic=False, probs=[], s_kwargs={})
 |
 |  Class for defining and interacting with random states of the model.
 |
 |  Attributes
 |  ----------
 |  rng : np.random.default_rng
 |      random number generator
 |  probs : list
 |      probability of the given states
 |  seed : int
 |      state for the random number generator
 |
 |  Rand is meant to be extended in model definition with random states, e.g.:
 |
 |  class RandState(State):
 |      noise: float=1.0
 |  class ExampleRand(Rand):
 |      s= RandState()
 |      run_stochastic:     bool=True
 |
 |  Which enables the use of set_rand, update_stochastic_states, etc for updating
 |  these states with methods called from the rng.
 |
 |  Method resolution order:
 |      Rand
 |      recordclass.datatype.dataobject
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  __init__(self, *args, seed=42, run_stochastic=False, probs=[], s_kwargs={})
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  assign(self, other_rand)
 |
 |  create_hist(self, timerange, track)
 |      Creates a History corresponding to Rand
 |
 |      Parameters
 |      ----------
 |      timerange : iterable, optional
 |          Time-range to initialize the history over. The default is None.
 |      track : list/str/dict, optional
 |          argument specifying attributes for :func:`get_sub_include&#39;. The default is None.
 |              DESCRIPTION. The default is None.
 |
 |      Returns
 |      -------
 |      hist : History
 |          History of fields specified in track.
 |
 |  get_rand_states(self, auto_update_only=False)
 |
 |  get_true_field(self, fieldname, *args, **kwargs)
 |
 |  get_true_fields(self, *args, **kwargs)
 |
 |  reset(self)
 |      Resets Rand to the initial state.
 |
 |  return_mutables(self)
 |
 |  return_probdens(self)
 |
 |  set_rand(self, statename, methodname, *args)
 |      Update the given random state with a given method and arguments (if in run_stochastic mode)
 |
 |      Parameters
 |      ----------
 |      statename : str
 |          name of the random state defined in assoc_rand_state(s)
 |      methodname :
 |          str name of the numpy method to call in the rng
 |      *args : args
 |          arguments for the numpy method
 |
 |  to_default(self, *statenames)
 |      Resets given random states to their default values
 |
 |  update_seed(self, seed)
 |      Updates the random seed to the given value
 |
 |  update_stochastic_states(self)
 |      Updates the defined stochastic states defined to auto-update.
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)
 |
 |  probdens
 |
 |  probs
 |
 |  rng
 |
 |  run_stochastic
 |
 |  seed
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __annotations__ = {&#39;probdens&#39;: &lt;class &#39;float&#39;&gt;, &#39;probs&#39;: &lt;class &#39;list&#39;...
 |
 |  __defaults__ = (None, [], 1.0, 42, False)
 |
 |  __fields__ = (&#39;rng&#39;, &#39;probs&#39;, &#39;probdens&#39;, &#39;seed&#39;, &#39;run_stochastic&#39;)
 |
 |  __options__ = {&#39;deep_dealloc&#39;: False, &#39;fast_new&#39;: True, &#39;gc&#39;: False, &#39;...
 |
 |  default_track = (&#39;s&#39;, &#39;probdens&#39;)
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from recordclass.datatype.dataobject:
 |
 |  __copy__(...)
 |      T.__copy__() -- copy of T
 |
 |  __eq__(self, value, /)
 |      Return self==value.
 |
 |  __ge__(self, value, /)
 |      Return self&gt;=value.
 |
 |  __getstate__(...)
 |      T.__getstate__()
 |
 |  __gt__(self, value, /)
 |      Return self&gt;value.
 |
 |  __hash__(self, /)
 |      Return hash(self).
 |
 |  __le__(self, value, /)
 |      Return self&lt;=value.
 |
 |  __len__(self, /)
 |      Return len(self).
 |
 |  __lt__(self, value, /)
 |      Return self&lt;value.
 |
 |  __ne__(self, value, /)
 |      Return self!=value.
 |
 |  __reduce__(...)
 |      T.__reduce__()
 |
 |  __repr__(...)
 |      T.__repr__() -- representation of T
 |
 |  __setstate__(...)
 |      T.__setstate__()
 |
 |  __sizeof__(...)
 |      T.__sizeof__() -- size of T
 |
 |  ----------------------------------------------------------------------
 |  Static methods inherited from recordclass.datatype.dataobject:
 |
 |  __new__(*args, **kwargs) from recordclass.datatype.datatype
 |      Create and return a new object.  See help(type) for accurate signature.

</pre></div></div>
</div>
<p>Below, <code class="docutils literal notranslate"><span class="pre">assoc_rand_states</span></code> is used in the ImportEE function to add two random states: - effstate, the quality of the input voltage (i.e. large fluctuations from a step change in power) - grid_noise, which is meant to be fluctuations in voltage from the power source (i.e., more ordinary noise)</p>
<p>This is then reflected in the behavior, which is defined in the <code class="docutils literal notranslate"><span class="pre">Rand.set_rand</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">Rand</span><span class="o">.</span><span class="n">set_rand</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function set_rand in module fmdtools.define.rand:

set_rand(self, statename, methodname, *args)
    Update the given random state with a given method and arguments (if in run_stochastic mode)

    Parameters
    ----------
    statename : str
        name of the random state defined in assoc_rand_state(s)
    methodname :
        str name of the numpy method to call in the rng
    *args : args
        arguments for the numpy method

</pre></div></div>
</div>
<p>In this method, <code class="docutils literal notranslate"><span class="pre">statename</span></code> is the name of the random state, while <code class="docutils literal notranslate"><span class="pre">methodname</span></code> corresponds to the name of a random distribution to update the state from. These distributions are pulled from a numpy random number generator and thus the options for distributions are provided in the numpy documentation: <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#distributions">https://numpy.org/doc/stable/reference/random/generator.html#distributions</a> . These distributions include most one might need including normal, beta, uniform, etc.</p>
<p><code class="docutils literal notranslate"><span class="pre">*args</span></code> in <code class="docutils literal notranslate"><span class="pre">set_rand</span></code> refers to the corresponding arguments to call the given method with, which should be pulled from the corresponding documentation. Below, we have points where this is called. - First, to pull <code class="docutils literal notranslate"><span class="pre">effstate</span></code> from a triangular distribution with minimum 0.9, mode 1.0, and max 1.1 - Parameters are provided here: <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.triangular.html#numpy.random.Generator.triangular">https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.triangular.html#numpy.random.Generator.triangular</a> - Second, to pull <code class="docutils literal notranslate"><span class="pre">grid_noise</span></code> from
a normal distribution centered on 1 with a standard deviation that varies over time according to a sine wave. - Parameters are provided here: <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html#numpy.random.Generator.normal">https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html#numpy.random.Generator.normal</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">ImportEE</span><span class="o">.</span><span class="n">behavior</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    def behavior(self,time):
        if self.m.has_fault(&#39;no_v&#39;):      self.r.s.effstate=0.0 #an open circuit means no voltage is exported
        elif self.m.has_fault(&#39;inf_v&#39;):   self.r.s.effstate=100.0 #a voltage spike means voltage is much higher
        else:
            if time&gt;self.t.time: self.r.set_rand(&#39;effstate&#39;,&#39;triangular&#39;,0.9,1,1.1)
        if time&gt;self.t.time:
            self.r.set_rand(&#39;grid_noise&#39;,&#39;normal&#39;,1, 0.05*(2+np.sin(np.pi/2*time)))
        self.ee_out.s.voltage= self.r.s.grid_noise*self.r.s.effstate * 500

</pre></div></div>
</div>
<p>The Import Signal function has a similar setup, where <code class="docutils literal notranslate"><span class="pre">sig_noise</span></code> is associated as a random state and then pulled as a random choice from a given set of options. To vary the behavior, here the noise is only pulled every five seconds.</p>
<p>This function also uses the <code class="docutils literal notranslate"><span class="pre">to_default</span></code> method, whic resets a given stochastic state to its default value. Here this is used to zero out any signal noise which would otherwise occur when there is no power.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">Rand</span><span class="o">.</span><span class="n">to_default</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function to_default in module fmdtools.define.rand:

to_default(self, *statenames)
    Resets given random states to their default values

</pre></div></div>
</div>
<p>The advantage of this is that simple stochastic behaviors do not need to be defined in the behavior method, however, it is less flexible than the previous approach, since one is limited to always drawing from the same distribution at each time-step. The resulting behavior method (below) thus has no <code class="docutils literal notranslate"><span class="pre">set_rand</span></code> call, since the state <code class="docutils literal notranslate"><span class="pre">eff</span></code> is automaticall updated outside the behavior definition.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">MoveWat</span><span class="o">.</span><span class="n">behavior</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    def behavior(self, time):
        self.s.eff=self.r.s.eff
        super().behavior(time)
        if time&gt;self.t.time: self.s.inc(total_flow=self.wat_out.s.flowrate)

</pre></div></div>
</div>
<p>Finally, it can be helpful for stochastic simulation to include a default seed in the model’s modelparams, as shown.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">Pump</span><span class="o">.</span><span class="fm">__init__</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    def __init__(self, **kwargs):
        super().__init__(**kwargs)

        self.add_flow(&#39;ee_1&#39;,   Electricity)
        self.add_flow(&#39;sig_1&#39;,  Signal)
        self.add_flow(&#39;wat_1&#39;,  Water(&#39;Wat_1&#39;))
        self.add_flow(&#39;wat_2&#39;,  Water(&#39;Wat_1&#39;))

        self.add_fxn(&#39;import_ee&#39;,    ImportEE,      &#39;ee_1&#39;)
        self.add_fxn(&#39;import_water&#39;, ImportWater,   &#39;wat_1&#39;)
        self.add_fxn(&#39;import_signal&#39;,ImportSig,     &#39;sig_1&#39;)
        self.add_fxn(&#39;move_water&#39;,   MoveWat,       &#39;ee_1&#39;, &#39;sig_1&#39;, &#39;wat_1&#39;, &#39;wat_2&#39;, p = {&#39;delay&#39;:self.p.delay})
        self.add_fxn(&#39;export_water&#39;, ExportWater,   &#39;wat_2&#39;)

        self.build()

</pre></div></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">seed</span></code> parameter ensures that each simulation in the same random thread will produce the same results, and that results can be replicated from stochastic simulation by running the model with the same seed.</p>
</section>
<section id="Simulation-and-Analysis">
<h2>Simulation and Analysis<a class="headerlink" href="#Simulation-and-Analysis" title="Permalink to this headline"></a></h2>
<p>With this model set up, we can now simulate it using the methods in <code class="docutils literal notranslate"><span class="pre">propagate</span></code>.</p>
<section id="Single-Scenario-Simulation">
<h3>Single-Scenario Simulation<a class="headerlink" href="#Single-Scenario-Simulation" title="Permalink to this headline"></a></h3>
<p>First, let’s simulate it in the nominal scenario:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_22_0.png" src="../../_images/examples_pump_Stochastic_Modelling_22_0.png" />
</div>
</div>
<p>As shown, even with all of these random states, it doesn’t appear that the behavior actually changes stochastically over time. This is because, by default, the model is set to run <em>deterministically</em>, meaning the stochastic states take their default values. To run stochastically, we use the option <code class="docutils literal notranslate"><span class="pre">run_stochastic=True</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_25_0.png" src="../../_images/examples_pump_Stochastic_Modelling_25_0.png" />
</div>
</div>
<p>As shown, this is more what we would expect from a random . Note that this simulation comes from the default model seed, and will this will always be the same. To get a different seed, we can pass new modelparams as an argument to <code class="docutils literal notranslate"><span class="pre">propagate.nominal</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">nominal</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">mdl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">110</span><span class="p">}))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_27_0.png" src="../../_images/examples_pump_Stochastic_Modelling_27_0.png" />
</div>
</div>
<p>We can further simulate faults as we would before.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">one_fault</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="s1">&#39;export_water&#39;</span><span class="p">,</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                       <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mdl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">110</span><span class="p">}))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">,</span> <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;move_water.s.total_flow&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;wat_2.s.flowrate&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;wat_2.s.pressure&#39;</span><span class="p">,</span>
                       <span class="n">time_slice</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_29_0.png" src="../../_images/examples_pump_Stochastic_Modelling_29_0.png" />
</div>
</div>
<p>As shown the stochastic states still simulated over time after the fault. One thing to watch is thus that the stochastic update in the faulty scenario does or does not change the variables compared to the nominal state–since many of the visualizations (e.g., in <code class="docutils literal notranslate"><span class="pre">graph</span></code>) are based on finding <em>differences</em> between faulty and nominal models to visualize degradation, these methods may be less useful/reliable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_31_0.png" src="../../_images/examples_pump_Stochastic_Modelling_31_0.png" />
</div>
</div>
<p>In the blockage scenario, there is no effect on the underlying stochastic states, since nothing was set up for this in the behavior. In the <code class="docutils literal notranslate"><span class="pre">no_sig</span></code> fault, on the other hand, we defined the signal noise to go to zero, as shown:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdl</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">()</span>
<span class="n">endclass</span><span class="p">,</span> <span class="n">mdlhist</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">one_fault</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span> <span class="s1">&#39;import_signal&#39;</span><span class="p">,</span> <span class="s1">&#39;no_sig&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                        <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mdl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span><span class="mi">110</span><span class="p">}))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhist</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;import_signal.r.s.sig_noise&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span>
                   <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">time_slice</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_33_0.png" src="../../_images/examples_pump_Stochastic_Modelling_33_0.png" />
</div>
</div>
</section>
<section id="Multi-Scenario-Simulation">
<h3>Multi-Scenario Simulation<a class="headerlink" href="#Multi-Scenario-Simulation" title="Permalink to this headline"></a></h3>
<p>Because stochastic models are non-deterministic, we are often interested not in the results of a single thread, but of the distribution of outcomes that might occur. To perform this kind of assessment, we can use a <code class="docutils literal notranslate"><span class="pre">NominalApproach</span></code> to instantiate the model with a number of different seeds.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">NominalApproach</span><span class="o">.</span><span class="n">add_seed_replicates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function add_seed_replicates in module fmdtools.sim.approach:

add_seed_replicates(self, rangeid, seeds)
    Generates an approach with different seeds to use for the model&#39;s internal stochastic behaviors

    Parameters
    ----------
    rangeid : str
        Name for the set of replicates
    seeds : int/list
        Number of seeds (if an int) or a list of seeds to use.

</pre></div></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">seeds</span></code> option can also be used in several other NominalApproach methods to simultaneously change the input parameters and seeds of the model. Below, we create an approach to simulate the model 100 times.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">NominalApproach</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_seed_replicates</span><span class="p">(</span><span class="s1">&#39;test_seeds&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses</span><span class="p">,</span> <span class="n">mdlhists</span><span class="o">=</span><span class="n">propagate</span><span class="o">.</span><span class="n">nominal_approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span><span class="n">app</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SCENARIOS COMPLETE: 100%|████████████████████████████████████████████████████████████| 100/100 [00:02&lt;00:00, 41.68it/s]
</pre></div></div>
</div>
<p>To evaluate this behavior over time, we can then use <code class="docutils literal notranslate"><span class="pre">an.plot.mdlhists</span></code>, which will plot the <em>distribution</em> of behaviors over time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function hist in module fmdtools.analyze.plot:

hist(simhists, *plot_values, cols=2, aggregation=&#39;individual&#39;, comp_groups={&#39;nominal&#39;: &#39;nominal&#39;, &#39;faulty&#39;: &#39;faulty&#39;}, legend_loc=-1, xlabel=&#39;time&#39;, ylabels={}, max_ind=&#39;max&#39;, boundtype=&#39;fill&#39;, fillalpha=0.3, boundcolor=&#39;gray&#39;, boundlinestyle=&#39;--&#39;, ci=0.95, titles={}, title=&#39;&#39;, indiv_kwargs={&#39;nominal&#39;: {&#39;color&#39;: &#39;blue&#39;, &#39;ls&#39;: &#39;--&#39;}, &#39;faulty&#39;: {&#39;color&#39;: &#39;red&#39;}}, time_slice=[], time_slice_label=None, figsize=&#39;default&#39;, v_padding=None, h_padding=None, title_padding=0.0, phases={}, modephases={}, label_phases=True, legend_title=None, **kwargs)
    Plot the behavior over time of the given function/flow values
    over a set of scenarios, with ability to aggregate behaviors as needed.

    Parameters
    ----------
    simhists : History
        Simulation history
    plot_values : strs, optional
        names of values to pull from the history (e.g., &#39;fxns.move_water.s.flowrate&#39;).
        Can also be specified as a dict (e.g. {&#39;fxns&#39;:&#39;move_water&#39;}) to get all keys
        from a given fxn/flow/mode/etc.
    cols : int, optional
        columns to use in the figure. The default is 2.
    aggregation : str, optional
        Way of aggregating the plot values. The default is &#39;individual&#39;
        Note that only the `individual` option can be used for histories of non-numeric quantities
        (e.g., modes, which are recorded as strings)
        - &#39;individual&#39; plots each run individually.
        - &#39;mean_std&#39; plots the mean values over the sim with standard deviation error bars
        - &#39;mean_ci&#39;  plots the mean values over the sim with mean confidence interval error bars
            - optional argument ci (float 0.0-1.0) specifies the confidence interval (Default:0.95)
        - &#39;mean_bound&#39; plots the mean values over the sim with variable bound error bars
        - &#39;percentile&#39; plots the percentile distribution of the sim over time (does not reject outliers)
            - optional argument &#39;perc_range&#39; (int 0-100) specifies the percentile range of the inner bars (Default: 50)
    comp_groups : dict, optional
        Dictionary for comparison groups (if more than one) with structure:
            {&#39;group1&#39;:(&#39;scen1&#39;, &#39;scen2&#39;), &#39;group2&#39;:(&#39;scen3&#39;, &#39;scen4&#39;)} Default is {}
            If a legend is shown, group names are used as labels.
    legend_loc : int, optional
        Specifies the plot to place the legend on, if runs are bine compared. Default is -1 (the last plot)
        To remove the legend, give a value of False
    xlabel : str, optional
        Label for the x-axes. Default is &#39;time&#39;
    ylabels : dict, optional
        Label for the y-axes with structure {(fxnflowname, value):&#39;label&#39;}
    max_ind : int, optional
        index (usually correlates to time) cutoff for the simulation. Default is &#39;max&#39; which uses the first simulation termination time.
    boundtype : &#39;fill&#39; or &#39;line&#39;, optional
        -&#39;fill&#39; plots the error bounds as a filled area
            - optional fillalpha (float) changes the alpha of this area.
        -&#39;line&#39; plots the error bounds as lines
            - optional boundcolor (str) changes the color of the bounds (default &#39;gray&#39;)
            - optional boundlinestyle (str) changes the style of the bound lines (default &#39;--&#39;)
    fillalpha : float
        alpha value for fill in aggregated plots. Default is 0.3.
    boundcolor : str, optional
        color to make the bounds in aggregated plots. Default is &#39;gray&#39;
    boundlinestyle : str, optional
        linestyle to use for bounds in aggregated plots. Default is &#39;--&#39;
    ci : float, optional
        Bootstrap confidence interval (0-1) to use in &#39;mean_ci&#39; bound argument. Default is 0.95.
    title : str, optional
        overall title for the plot. Default is &#39;&#39;
    indiv_kwargs : dict, optional
        dict of kwargs with structure {comp1:kwargs1, comp2:kwargs2}, where
        where kwargs is an individual dict of keyword arguments for the
        comparison group comp (or scenario, if not aggregated) which overrides
        the global kwargs (or default behavior). If no comparison groups are given,
        use &#39;default&#39; for a single history or &#39;nominal&#39;/&#39;faulty&#39; for a fault history
        e.g. kwargs = {&#39;nominal&#39;:{color:&#39;green&#39;}} would make the nominal color green
        Default is {}.
    time_slice : int/list, optional
        overlays a bar or bars at the given index when the fault was injected (if any). Default is []
    time_slice_label : str, optional
        label to use for the time slice bars in the legend. Default is None
    figsize : tuple (float,float)
        x-y size for the figure. The default is &#39;default&#39;, which dymanically gives 3 for each column and 2 for each row
    v_padding : float
        vertical padding between subplots as a fraction of axis height
    h_padding : float
        horizontal padding between subplots as a fraction of axis width
    title_padding : float
        padding for title as a fraction of figure height
    phases : dict, optional
        Provide to overlay phases on the individual function histories, where phases
        is from an.process.mdlhist and of structure {&#39;fxnname&#39;:&#39;phase&#39;:[start, end]}.
        Default is {}.
    modephases : dict, optional
        dictionary that maps the phases to operational modes, if it is desired to track the progression
        through modes
    legend_title : str, optional
        title for the legend. Default is None
    **kwargs : kwargs
        keyword arguments to mpl.plot e.g. linestyle, color, etc. See &#39;aggregation&#39; for specification.
        phases={}, modephases={}, label_phases=True,  **kwargs):

</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">an.plot.hist</span></code> has a number of different options for visualization. For example, below we plot model states as individual lines:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhists</span><span class="p">,</span> <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;move_water.s.total_flow&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;wat_2.s.pressure&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;sig_1.s.power&#39;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">comp_groups</span><span class="o">=</span><span class="p">{},</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_42_0.png" src="../../_images/examples_pump_Stochastic_Modelling_42_0.png" />
</div>
</div>
<p>Or as percentiles:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhists</span><span class="p">,</span> <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;move_water.s.total_flow&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;wat_2.s.pressure&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;sig_1.s.power&#39;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">comp_groups</span><span class="o">=</span><span class="p">{},</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_44_0.png" src="../../_images/examples_pump_Stochastic_Modelling_44_0.png" />
</div>
</div>
<p>Or as a mean with confidence interval:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mdlhists</span><span class="p">,</span> <span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;move_water.s.total_flow&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;wat_2.s.pressure&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;sig_1.s.power&#39;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">comp_groups</span><span class="o">=</span><span class="p">{},</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;mean_ci&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_46_0.png" src="../../_images/examples_pump_Stochastic_Modelling_46_0.png" />
</div>
</div>
</section>
<section id="Nested-Fault-Simulation">
<h3>Nested Fault Simulation<a class="headerlink" href="#Nested-Fault-Simulation" title="Permalink to this headline"></a></h3>
<p>We can also compare stochastic output over a set of scenarios using <code class="docutils literal notranslate"><span class="pre">plot.hist</span></code> with the <code class="docutils literal notranslate"><span class="pre">comp_groups</span></code> parameter, which places the scenarios in different groups.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">paramfunc</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;delay&#39;</span><span class="p">:</span><span class="n">delay</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>This can be done by first creating an approach with two parameters we wish to compare. The pump still has one real parameter–the fault delay.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">app_comp</span> <span class="o">=</span> <span class="n">NominalApproach</span><span class="p">()</span>
<span class="n">app_comp</span><span class="o">.</span><span class="n">add_param_replicates</span><span class="p">(</span><span class="n">paramfunc</span><span class="p">,</span> <span class="s1">&#39;delay_1&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">app_comp</span><span class="o">.</span><span class="n">add_param_replicates</span><span class="p">(</span><span class="n">paramfunc</span><span class="p">,</span> <span class="s1">&#39;delay_10&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since this delay only shows up in blockage fault modes, to compare the behaviors, we will first simulate it in a nested approach with only the blockage fault added.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pool</span><span class="o">=</span><span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endclasses</span><span class="p">,</span> <span class="n">mdlhists</span><span class="p">,</span> <span class="n">apps</span><span class="o">=</span><span class="n">propagate</span><span class="o">.</span><span class="n">nested_approach</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span><span class="n">app_comp</span><span class="p">,</span> <span class="n">run_stochastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">faults</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;export_water&#39;</span><span class="p">,</span><span class="s1">&#39;block&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  42%|██████████████████████▍                               | 83/200 [00:09&lt;00:13,  8.58it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;import_ee&#39;: [&#39;no_v&#39;]}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE:  50%|██████████████████████████▌                          | 100/200 [00:11&lt;00:11,  8.74it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
Faults found during the nominal run {&#39;move_water&#39;: [&#39;mech_break&#39;]}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
NESTED SCENARIOS COMPLETE: 100%|█████████████████████████████████████████████████████| 200/200 [00:23&lt;00:00,  8.39it/s]
</pre></div></div>
</div>
<p>Next, we get just the scenarios of interest:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_mdlhists</span> <span class="o">=</span> <span class="n">mdlhists</span><span class="o">.</span><span class="n">get_scens</span><span class="p">(</span><span class="s1">&#39;export_water_block_t27p0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, we create some comparison groups to group the results by:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_groups</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;delay_1&#39;</span><span class="p">:</span> <span class="n">app_comp</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="s1">&#39;delay_1&#39;</span><span class="p">][</span><span class="s1">&#39;scenarios&#39;</span><span class="p">],</span> <span class="s1">&#39;delay_10&#39;</span><span class="p">:</span><span class="n">app_comp</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="s1">&#39;delay_10&#39;</span><span class="p">][</span><span class="s1">&#39;scenarios&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</div>
<p>These are the resulting behaviors:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">comp_mdlhists</span><span class="p">,</span><span class="s1">&#39;move_water.r.s.eff&#39;</span><span class="p">,</span> <span class="s1">&#39;move_water.s.total_flow&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;wat_2.s.flowrate&#39;</span><span class="p">,</span> <span class="s1">&#39;wat_2.s.pressure&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;import_ee.r.s.effstate&#39;</span><span class="p">,</span> <span class="s1">&#39;import_ee.r.s.grid_noise&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ee_1.s.voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;sig_1.s.power&#39;</span><span class="p">,</span>
                    <span class="n">comp_groups</span><span class="o">=</span><span class="n">comp_groups</span><span class="p">,</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span> <span class="n">time_slice</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_pump_Stochastic_Modelling_61_0.png" src="../../_images/examples_pump_Stochastic_Modelling_61_0.png" />
</div>
</div>
<p>There a few interesting aspects of this simulation: - First, some of the <code class="docutils literal notranslate"><span class="pre">delay_1</span></code> design simulations have a zero flowrate before the fault is injected. This is because the reduced delay means that nominal behavior can easily cause the fault–all that nees to happen is for the pressure to go over 15 for two time-steps, which is entirely forseeable with all the variability in the simulation. This can also be seen in the “total_flow” graph. - Second, the <code class="docutils literal notranslate"><span class="pre">delay_10</span></code> gives the nominal behavior
until the fault time, when pressure increases dramatically. This is also observed in the <code class="docutils literal notranslate"><span class="pre">delay_1</span></code> design, but with a much smaller delay (1 instead of 1).</p>
<p>Finally, running multiple simulations relies on the NominalApproach, it can be combined fairly easily with existing methods used in conjunction with NominalApproach. (e.g., <code class="docutils literal notranslate"><span class="pre">tabulate.nested_stats</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">an</span><span class="o">.</span><span class="n">tabulate</span><span class="o">.</span><span class="n">nested_stats</span><span class="p">(</span><span class="n">app_comp</span><span class="p">,</span> <span class="n">endclasses</span><span class="p">,</span> <span class="n">average_metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">],</span> <span class="n">inputparams</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>delay_1_1.export_water_block_t2p0.endclass.rate</th>
      <th>delay_1_1.export_water_block_t2p0.endclass.cost</th>
      <th>delay_1_1.export_water_block_t2p0.endclass.expected cost</th>
      <th>delay_1_1.export_water_block_t27p0.endclass.rate</th>
      <th>delay_1_1.export_water_block_t27p0.endclass.cost</th>
      <th>delay_1_1.export_water_block_t27p0.endclass.expected cost</th>
      <th>delay_1_1.export_water_block_t52p0.endclass.rate</th>
      <th>delay_1_1.export_water_block_t52p0.endclass.cost</th>
      <th>delay_1_1.export_water_block_t52p0.endclass.expected cost</th>
      <th>delay_1_1.nominal.endclass.rate</th>
      <th>...</th>
      <th>delay_10_200.export_water_block_t2p0.endclass.expected cost</th>
      <th>delay_10_200.export_water_block_t27p0.endclass.rate</th>
      <th>delay_10_200.export_water_block_t27p0.endclass.cost</th>
      <th>delay_10_200.export_water_block_t27p0.endclass.expected cost</th>
      <th>delay_10_200.export_water_block_t52p0.endclass.rate</th>
      <th>delay_10_200.export_water_block_t52p0.endclass.cost</th>
      <th>delay_10_200.export_water_block_t52p0.endclass.expected cost</th>
      <th>delay_10_200.nominal.endclass.rate</th>
      <th>delay_10_200.nominal.endclass.cost</th>
      <th>delay_10_200.nominal.endclass.expected cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>delay</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>ave_cost</th>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>41009.073401</td>
      <td>...</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
      <td>39606.301057</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 2400 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">an</span><span class="o">.</span><span class="n">tabulate</span><span class="o">.</span><span class="n">resilience_factor_comparison</span><span class="p">(</span><span class="n">app_comp</span><span class="p">,</span> <span class="n">endclasses</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">],</span> <span class="s1">&#39;cost&#39;</span><span class="p">,</span>  <span class="n">difference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\Temp\1/ipykernel_18972/82623819.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>an<span class="ansi-yellow-intense-fg ansi-bold">.</span>tabulate<span class="ansi-yellow-intense-fg ansi-bold">.</span>resilience_factor_comparison<span class="ansi-yellow-intense-fg ansi-bold">(</span>app_comp<span class="ansi-yellow-intense-fg ansi-bold">,</span> endclasses<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-blue-intense-fg ansi-bold">&#39;delay&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;cost&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>  difference<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> percent<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\users\dhulse\documents\github\fmdtools\fmdtools\analyze\tabulate.py</span> in <span class="ansi-cyan-fg">resilience_factor_comparison</span><span class="ansi-blue-intense-fg ansi-bold">(nomapp, nested_endclasses, params, value, faults, rangeid, nan_as, percent, difference, give_ci, **kwargs)</span>
<span class="ansi-green-fg">    275</span>             factors <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">{</span>rangeid<span class="ansi-yellow-intense-fg ansi-bold">:</span>nomapp<span class="ansi-yellow-intense-fg ansi-bold">.</span>ranges<span class="ansi-yellow-intense-fg ansi-bold">[</span>rangeid<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-blue-intense-fg ansi-bold">&#39;scenarios&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> rangeid <span class="ansi-green-intense-fg ansi-bold">in</span> nomapp<span class="ansi-yellow-intense-fg ansi-bold">.</span>ranges<span class="ansi-yellow-intense-fg ansi-bold">}</span>
<span class="ansi-green-fg">    276</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span> factors <span class="ansi-yellow-intense-fg ansi-bold">=</span> nomapp<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_param_scens<span class="ansi-yellow-intense-fg ansi-bold">(</span>rangeid<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>params<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 277</span><span class="ansi-yellow-intense-fg ansi-bold">     </span><span class="ansi-green-intense-fg ansi-bold">if</span> faults<span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-blue-intense-fg ansi-bold">&#39;functions&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>     faultlist <span class="ansi-yellow-intense-fg ansi-bold">=</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>e<span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39; &#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> scen <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses <span class="ansi-green-intense-fg ansi-bold">for</span> e <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses<span class="ansi-yellow-intense-fg ansi-bold">[</span>scen<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    278</span>     <span class="ansi-green-intense-fg ansi-bold">elif</span> faults<span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-blue-intense-fg ansi-bold">&#39;modes&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>       faultlist <span class="ansi-yellow-intense-fg ansi-bold">=</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>e<span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;,&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> scen <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses <span class="ansi-green-intense-fg ansi-bold">for</span> e <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses<span class="ansi-yellow-intense-fg ansi-bold">[</span>scen<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    279</span>     <span class="ansi-green-intense-fg ansi-bold">elif</span> faults<span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-blue-intense-fg ansi-bold">&#39;mode type&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>   faultlist <span class="ansi-yellow-intense-fg ansi-bold">=</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>e<span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;,&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39; &#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> scen <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses <span class="ansi-green-intense-fg ansi-bold">for</span> e <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses<span class="ansi-yellow-intense-fg ansi-bold">[</span>scen<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\users\dhulse\documents\github\fmdtools\fmdtools\analyze\tabulate.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(.0)</span>
<span class="ansi-green-fg">    275</span>             factors <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">{</span>rangeid<span class="ansi-yellow-intense-fg ansi-bold">:</span>nomapp<span class="ansi-yellow-intense-fg ansi-bold">.</span>ranges<span class="ansi-yellow-intense-fg ansi-bold">[</span>rangeid<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-blue-intense-fg ansi-bold">&#39;scenarios&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> rangeid <span class="ansi-green-intense-fg ansi-bold">in</span> nomapp<span class="ansi-yellow-intense-fg ansi-bold">.</span>ranges<span class="ansi-yellow-intense-fg ansi-bold">}</span>
<span class="ansi-green-fg">    276</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span> factors <span class="ansi-yellow-intense-fg ansi-bold">=</span> nomapp<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_param_scens<span class="ansi-yellow-intense-fg ansi-bold">(</span>rangeid<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>params<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 277</span><span class="ansi-yellow-intense-fg ansi-bold">     </span><span class="ansi-green-intense-fg ansi-bold">if</span> faults<span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-blue-intense-fg ansi-bold">&#39;functions&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>     faultlist <span class="ansi-yellow-intense-fg ansi-bold">=</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>e<span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39; &#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> scen <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses <span class="ansi-green-intense-fg ansi-bold">for</span> e <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses<span class="ansi-yellow-intense-fg ansi-bold">[</span>scen<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    278</span>     <span class="ansi-green-intense-fg ansi-bold">elif</span> faults<span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-blue-intense-fg ansi-bold">&#39;modes&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>       faultlist <span class="ansi-yellow-intense-fg ansi-bold">=</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>e<span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;,&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> scen <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses <span class="ansi-green-intense-fg ansi-bold">for</span> e <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses<span class="ansi-yellow-intense-fg ansi-bold">[</span>scen<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    279</span>     <span class="ansi-green-intense-fg ansi-bold">elif</span> faults<span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-blue-intense-fg ansi-bold">&#39;mode type&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>   faultlist <span class="ansi-yellow-intense-fg ansi-bold">=</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>e<span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;,&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>partition<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39; &#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> scen <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses <span class="ansi-green-intense-fg ansi-bold">for</span> e <span class="ansi-green-intense-fg ansi-bold">in</span> nested_endclasses<span class="ansi-yellow-intense-fg ansi-bold">[</span>scen<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">TypeError</span>: &#39;float&#39; object is not iterable
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>